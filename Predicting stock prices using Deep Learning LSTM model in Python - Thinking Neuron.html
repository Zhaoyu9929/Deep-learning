<!DOCTYPE html>
<!-- saved from url=(0092)https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/ -->
<html dir="ltr" lang="en" prefix="og: https://ogp.me/ns#" class="fontawesome-i2svg-active fontawesome-i2svg-complete"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1">
<style type="text/css">svg:not(:root).svg-inline--fa{overflow:visible}.svg-inline--fa{display:inline-block;font-size:inherit;height:1em;overflow:visible;vertical-align:-.125em}.svg-inline--fa.fa-lg{vertical-align:-.225em}.svg-inline--fa.fa-w-1{width:.0625em}.svg-inline--fa.fa-w-2{width:.125em}.svg-inline--fa.fa-w-3{width:.1875em}.svg-inline--fa.fa-w-4{width:.25em}.svg-inline--fa.fa-w-5{width:.3125em}.svg-inline--fa.fa-w-6{width:.375em}.svg-inline--fa.fa-w-7{width:.4375em}.svg-inline--fa.fa-w-8{width:.5em}.svg-inline--fa.fa-w-9{width:.5625em}.svg-inline--fa.fa-w-10{width:.625em}.svg-inline--fa.fa-w-11{width:.6875em}.svg-inline--fa.fa-w-12{width:.75em}.svg-inline--fa.fa-w-13{width:.8125em}.svg-inline--fa.fa-w-14{width:.875em}.svg-inline--fa.fa-w-15{width:.9375em}.svg-inline--fa.fa-w-16{width:1em}.svg-inline--fa.fa-w-17{width:1.0625em}.svg-inline--fa.fa-w-18{width:1.125em}.svg-inline--fa.fa-w-19{width:1.1875em}.svg-inline--fa.fa-w-20{width:1.25em}.svg-inline--fa.fa-pull-left{margin-right:.3em;width:auto}.svg-inline--fa.fa-pull-right{margin-left:.3em;width:auto}.svg-inline--fa.fa-border{height:1.5em}.svg-inline--fa.fa-li{width:2em}.svg-inline--fa.fa-fw{width:1.25em}.fa-layers svg.svg-inline--fa{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.fa-layers{display:inline-block;height:1em;position:relative;text-align:center;vertical-align:-.125em;width:1em}.fa-layers svg.svg-inline--fa{-webkit-transform-origin:center center;transform-origin:center center}.fa-layers-counter,.fa-layers-text{display:inline-block;position:absolute;text-align:center}.fa-layers-text{left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);-webkit-transform-origin:center center;transform-origin:center center}.fa-layers-counter{background-color:#ff253a;border-radius:1em;color:#fff;height:1.5em;line-height:1;max-width:5em;min-width:1.5em;overflow:hidden;padding:.25em;right:0;text-overflow:ellipsis;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top right;transform-origin:top right}.fa-layers-bottom-right{bottom:0;right:0;top:auto;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:bottom right;transform-origin:bottom right}.fa-layers-bottom-left{bottom:0;left:0;right:auto;top:auto;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:bottom left;transform-origin:bottom left}.fa-layers-top-right{right:0;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top right;transform-origin:top right}.fa-layers-top-left{left:0;right:auto;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top left;transform-origin:top left}.fa-lg{font-size:1.33333em;line-height:.75em;vertical-align:-.0667em}.fa-xs{font-size:.75em}.fa-sm{font-size:.875em}.fa-1x{font-size:1em}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-6x{font-size:6em}.fa-7x{font-size:7em}.fa-8x{font-size:8em}.fa-9x{font-size:9em}.fa-10x{font-size:10em}.fa-fw{text-align:center;width:1.25em}.fa-ul{list-style-type:none;margin-left:2.5em;padding-left:0}.fa-ul>li{position:relative}.fa-li{left:-2em;position:absolute;text-align:center;width:2em;line-height:inherit}.fa-border{border:solid .08em #eee;border-radius:.1em;padding:.2em .25em .15em}.fa-pull-left{float:left}.fa-pull-right{float:right}.fa.fa-pull-left,.fab.fa-pull-left,.fal.fa-pull-left,.far.fa-pull-left,.fas.fa-pull-left{margin-right:.3em}.fa.fa-pull-right,.fab.fa-pull-right,.fal.fa-pull-right,.far.fa-pull-right,.fas.fa-pull-right{margin-left:.3em}.fa-spin{-webkit-animation:fa-spin 2s infinite linear;animation:fa-spin 2s infinite linear}.fa-pulse{-webkit-animation:fa-spin 1s infinite steps(8);animation:fa-spin 1s infinite steps(8)}@-webkit-keyframes fa-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes fa-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.fa-rotate-90{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fa-rotate-180{-webkit-transform:rotate(180deg);transform:rotate(180deg)}.fa-rotate-270{-webkit-transform:rotate(270deg);transform:rotate(270deg)}.fa-flip-horizontal{-webkit-transform:scale(-1,1);transform:scale(-1,1)}.fa-flip-vertical{-webkit-transform:scale(1,-1);transform:scale(1,-1)}.fa-flip-horizontal.fa-flip-vertical{-webkit-transform:scale(-1,-1);transform:scale(-1,-1)}:root .fa-flip-horizontal,:root .fa-flip-vertical,:root .fa-rotate-180,:root .fa-rotate-270,:root .fa-rotate-90{-webkit-filter:none;filter:none}.fa-stack{display:inline-block;height:2em;position:relative;width:2em}.fa-stack-1x,.fa-stack-2x{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.svg-inline--fa.fa-stack-1x{height:1em;width:1em}.svg-inline--fa.fa-stack-2x{height:2em;width:2em}.fa-inverse{color:#fff}.sr-only{border:0;clip:rect(0,0,0,0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.sr-only-focusable:active,.sr-only-focusable:focus{clip:auto;height:auto;margin:0;overflow:visible;position:static;width:auto}</style><link rel="profile" href="https://gmpg.org/xfn/11">


		<!-- All in One SEO 4.4.8 - aioseo.com -->
		<meta name="description" content="In this case study, I will show how LSTMs can be used to learn the patterns in the stock prices. Using this template you will be able to predict tomorrow&#39;s price of a stock based on the last 10 days prices.">
		<meta name="robots" content="max-image-preview:large">
		<link rel="canonical" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/">
		<meta name="generator" content="All in One SEO (AIOSEO) 4.4.8">
		<meta property="og:locale" content="en_US">
		<meta property="og:site_name" content="Thinking Neuron - Data Science application to real world problems!">
		<meta property="og:type" content="article">
		<meta property="og:title" content="Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron">
		<meta property="og:description" content="In this case study, I will show how LSTMs can be used to learn the patterns in the stock prices. Using this template you will be able to predict tomorrow&#39;s price of a stock based on the last 10 days prices.">
		<meta property="og:url" content="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/">
		<meta property="og:image" content="https://thinkingneuron.com/wp-content/uploads/2021/05/Logo-Thinking-Neuron-Black.png">
		<meta property="og:image:secure_url" content="https://thinkingneuron.com/wp-content/uploads/2021/05/Logo-Thinking-Neuron-Black.png">
		<meta property="og:image:width" content="4939">
		<meta property="og:image:height" content="741">
		<meta property="article:published_time" content="2020-10-05T15:36:43+00:00">
		<meta property="article:modified_time" content="2021-03-25T03:45:42+00:00">
		<meta name="twitter:card" content="summary_large_image">
		<meta name="twitter:title" content="Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron">
		<meta name="twitter:description" content="In this case study, I will show how LSTMs can be used to learn the patterns in the stock prices. Using this template you will be able to predict tomorrow&#39;s price of a stock based on the last 10 days prices.">
		<meta name="twitter:image" content="https://thinkingneuron.com/wp-content/uploads/2021/05/Logo-Thinking-Neuron-Black.png">
		<script type="application/ld+json" class="aioseo-schema">
			{"@context":"https:\/\/schema.org","@graph":[{"@type":"BlogPosting","@id":"https:\/\/thinkingneuron.com\/predicting-stock-prices-using-deep-learning-lstm-model-in-python\/#blogposting","name":"Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron","headline":"Predicting stock prices using Deep Learning LSTM model in Python","author":{"@id":"https:\/\/thinkingneuron.com\/author\/admin\/#author"},"publisher":{"@id":"https:\/\/thinkingneuron.com\/#organization"},"image":{"@type":"ImageObject","url":"https:\/\/thinkingneuron.com\/wp-content\/uploads\/2020\/10\/LSTM-architechture.png","width":1000,"height":361,"caption":"LSTM architecture"},"datePublished":"2020-10-05T15:36:43+00:00","dateModified":"2021-03-25T03:45:42+00:00","inLanguage":"en-US","commentCount":42,"mainEntityOfPage":{"@id":"https:\/\/thinkingneuron.com\/predicting-stock-prices-using-deep-learning-lstm-model-in-python\/#webpage"},"isPartOf":{"@id":"https:\/\/thinkingneuron.com\/predicting-stock-prices-using-deep-learning-lstm-model-in-python\/#webpage"},"articleSection":"Blog, Case Studies-Python, Deep Learning, Deep Learning, LSTM, Python Case Study, stock price prediction"},{"@type":"BreadcrumbList","@id":"https:\/\/thinkingneuron.com\/predicting-stock-prices-using-deep-learning-lstm-model-in-python\/#breadcrumblist","itemListElement":[{"@type":"ListItem","@id":"https:\/\/thinkingneuron.com\/#listItem","position":1,"name":"Home","item":"https:\/\/thinkingneuron.com\/","nextItem":"https:\/\/thinkingneuron.com\/predicting-stock-prices-using-deep-learning-lstm-model-in-python\/#listItem"},{"@type":"ListItem","@id":"https:\/\/thinkingneuron.com\/predicting-stock-prices-using-deep-learning-lstm-model-in-python\/#listItem","position":2,"name":"Predicting stock prices using Deep Learning LSTM model in Python","previousItem":"https:\/\/thinkingneuron.com\/#listItem"}]},{"@type":"Organization","@id":"https:\/\/thinkingneuron.com\/#organization","name":"Thinking Neuron","url":"https:\/\/thinkingneuron.com\/","logo":{"@type":"ImageObject","url":"https:\/\/thinkingneuron.com\/wp-content\/uploads\/2021\/05\/Logo-Thinking-Neuron-Black.png","@id":"https:\/\/thinkingneuron.com\/predicting-stock-prices-using-deep-learning-lstm-model-in-python\/#organizationLogo","width":4939,"height":741,"caption":"Thinking Neuron"},"image":{"@id":"https:\/\/thinkingneuron.com\/#organizationLogo"}},{"@type":"Person","@id":"https:\/\/thinkingneuron.com\/author\/admin\/#author","url":"https:\/\/thinkingneuron.com\/author\/admin\/","name":"Farukh Hashmi","image":{"@type":"ImageObject","@id":"https:\/\/thinkingneuron.com\/predicting-stock-prices-using-deep-learning-lstm-model-in-python\/#authorImage","url":"https:\/\/secure.gravatar.com\/avatar\/32461ffa804faacb2279c6b84ccf1f52?s=96&d=mm&r=g","width":96,"height":96,"caption":"Farukh Hashmi"}},{"@type":"WebPage","@id":"https:\/\/thinkingneuron.com\/predicting-stock-prices-using-deep-learning-lstm-model-in-python\/#webpage","url":"https:\/\/thinkingneuron.com\/predicting-stock-prices-using-deep-learning-lstm-model-in-python\/","name":"Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron","description":"In this case study, I will show how LSTMs can be used to learn the patterns in the stock prices. Using this template you will be able to predict tomorrow's price of a stock based on the last 10 days prices.","inLanguage":"en-US","isPartOf":{"@id":"https:\/\/thinkingneuron.com\/#website"},"breadcrumb":{"@id":"https:\/\/thinkingneuron.com\/predicting-stock-prices-using-deep-learning-lstm-model-in-python\/#breadcrumblist"},"author":{"@id":"https:\/\/thinkingneuron.com\/author\/admin\/#author"},"creator":{"@id":"https:\/\/thinkingneuron.com\/author\/admin\/#author"},"image":{"@type":"ImageObject","url":"https:\/\/thinkingneuron.com\/wp-content\/uploads\/2020\/10\/LSTM-architechture.png","@id":"https:\/\/thinkingneuron.com\/predicting-stock-prices-using-deep-learning-lstm-model-in-python\/#mainImage","width":1000,"height":361,"caption":"LSTM architecture"},"primaryImageOfPage":{"@id":"https:\/\/thinkingneuron.com\/predicting-stock-prices-using-deep-learning-lstm-model-in-python\/#mainImage"},"datePublished":"2020-10-05T15:36:43+00:00","dateModified":"2021-03-25T03:45:42+00:00"},{"@type":"WebSite","@id":"https:\/\/thinkingneuron.com\/#website","url":"https:\/\/thinkingneuron.com\/","name":"Thinking Neuron","description":"Data Science application to real world problems!","inLanguage":"en-US","publisher":{"@id":"https:\/\/thinkingneuron.com\/#organization"}}]}
		</script>
		<!-- All in One SEO -->


	<!-- This site is optimized with the Yoast SEO plugin v14.9 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron</title>
	<meta name="description" content="In this case study, I will show how LSTMs can be used to learn the patterns in the stock prices. Using this template you will be able to predict tomorrow&#39;s price of a stock based on the last 10 days prices.">
	<meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
	<link rel="canonical" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/">
	<meta property="og:locale" content="en_US">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron">
	<meta property="og:description" content="In this case study, I will show how LSTMs can be used to learn the patterns in the stock prices. Using this template you will be able to predict tomorrow&#39;s price of a stock based on the last 10 days prices.">
	<meta property="og:url" content="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/">
	<meta property="og:site_name" content="Thinking Neuron">
	<meta property="article:published_time" content="2020-10-05T15:36:43+00:00">
	<meta property="article:modified_time" content="2021-03-25T03:45:42+00:00">
	<meta property="og:image" content="https://thinkingneuron.com/wp-content/uploads/2020/10/LSTM-architechture.png">
	<meta property="og:image:width" content="1000">
	<meta property="og:image:height" content="361">
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:creator" content="@ThinkingNeuron">
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebSite","@id":"https://thinkingneuron.com/#website","url":"https://thinkingneuron.com/","name":"Thinking Neuron","description":"Data Science application to real world problems!","potentialAction":[{"@type":"SearchAction","target":"https://thinkingneuron.com/?s={search_term_string}","query-input":"required name=search_term_string"}],"inLanguage":"en-US"},{"@type":"ImageObject","@id":"https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#primaryimage","inLanguage":"en-US","url":"https://thinkingneuron.com/wp-content/uploads/2020/10/LSTM-architechture.png","width":1000,"height":361,"caption":"LSTM architecture"},{"@type":"WebPage","@id":"https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#webpage","url":"https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/","name":"Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron","isPartOf":{"@id":"https://thinkingneuron.com/#website"},"primaryImageOfPage":{"@id":"https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#primaryimage"},"datePublished":"2020-10-05T15:36:43+00:00","dateModified":"2021-03-25T03:45:42+00:00","author":{"@id":"https://thinkingneuron.com/#/schema/person/9f474739fea85a0ce426e83c44f1eb1f"},"description":"In this case study, I will show how LSTMs can be used to learn the patterns in the stock prices. Using this template you will be able to predict tomorrow's price of a stock based on the last 10 days prices.","inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/"]}]},{"@type":"Person","@id":"https://thinkingneuron.com/#/schema/person/9f474739fea85a0ce426e83c44f1eb1f","name":"Farukh Hashmi","image":{"@type":"ImageObject","@id":"https://thinkingneuron.com/#personlogo","inLanguage":"en-US","url":"https://secure.gravatar.com/avatar/32461ffa804faacb2279c6b84ccf1f52?s=96&d=mm&r=g","caption":"Farukh Hashmi"},"description":"Farukh is an innovator in solving industry problems using Artificial intelligence. His expertise is backed by 10 years of industry experience. Being a senior data scientist he is responsible for designing the AI/ML solution to provide maximum gains for the clients. As a thought leader, his focus is on solving the key business problems of the CPG Industry. He has worked across different domains like Telecom, Insurance, and Logistics. He has worked with global tech leaders including Infosys, IBM, and Persistent Systems. His passion to teach got him to start this blog!","sameAs":["https://www.linkedin.com/in/farukh-hashmi/","https://twitter.com/ThinkingNeuron","https://www.youtube.com/channel/UCqb03ZB4sRDvcT7O7DTI_Sg","https://thinkingneuron.com/about/"]}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel="dns-prefetch" href="https://use.fontawesome.com/">
<link rel="dns-prefetch" href="https://fonts.googleapis.com/">
<link rel="alternate" type="application/rss+xml" title="Thinking Neuron » Feed" href="https://thinkingneuron.com/feed/">
<link rel="alternate" type="application/rss+xml" title="Thinking Neuron » Comments Feed" href="https://thinkingneuron.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Thinking Neuron » Predicting stock prices using Deep Learning LSTM model in Python Comments Feed" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/feed/">
		<!-- This site uses the Google Analytics by MonsterInsights plugin v8.20.1 - Using Analytics tracking - https://www.monsterinsights.com/ -->
							<script src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/js" data-cfasync="false" data-wpfc-render="false" type="text/javascript" async=""></script>
			<script data-cfasync="false" data-wpfc-render="false" type="text/javascript">
				var mi_version = '8.20.1';
				var mi_track_user = true;
				var mi_no_track_reason = '';
				
								var disableStrs = [
										'ga-disable-G-Z3542E8PKD',
									];

				/* Function to detect opted out users */
				function __gtagTrackerIsOptedOut() {
					for (var index = 0; index < disableStrs.length; index++) {
						if (document.cookie.indexOf(disableStrs[index] + '=true') > -1) {
							return true;
						}
					}

					return false;
				}

				/* Disable tracking if the opt-out cookie exists. */
				if (__gtagTrackerIsOptedOut()) {
					for (var index = 0; index < disableStrs.length; index++) {
						window[disableStrs[index]] = true;
					}
				}

				/* Opt-out function */
				function __gtagTrackerOptout() {
					for (var index = 0; index < disableStrs.length; index++) {
						document.cookie = disableStrs[index] + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
						window[disableStrs[index]] = true;
					}
				}

				if ('undefined' === typeof gaOptout) {
					function gaOptout() {
						__gtagTrackerOptout();
					}
				}
								window.dataLayer = window.dataLayer || [];

				window.MonsterInsightsDualTracker = {
					helpers: {},
					trackers: {},
				};
				if (mi_track_user) {
					function __gtagDataLayer() {
						dataLayer.push(arguments);
					}

					function __gtagTracker(type, name, parameters) {
						if (!parameters) {
							parameters = {};
						}

						if (parameters.send_to) {
							__gtagDataLayer.apply(null, arguments);
							return;
						}

						if (type === 'event') {
														parameters.send_to = monsterinsights_frontend.v4_id;
							var hookName = name;
							if (typeof parameters['event_category'] !== 'undefined') {
								hookName = parameters['event_category'] + ':' + name;
							}

							if (typeof MonsterInsightsDualTracker.trackers[hookName] !== 'undefined') {
								MonsterInsightsDualTracker.trackers[hookName](parameters);
							} else {
								__gtagDataLayer('event', name, parameters);
							}
							
						} else {
							__gtagDataLayer.apply(null, arguments);
						}
					}

					__gtagTracker('js', new Date());
					__gtagTracker('set', {
						'developer_id.dZGIzZG': true,
											});
										__gtagTracker('config', 'G-Z3542E8PKD', {"forceSSL":"true","link_attribution":"true"} );
															window.gtag = __gtagTracker;										(function () {
						/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
						/* ga and __gaTracker compatibility shim. */
						var noopfn = function () {
							return null;
						};
						var newtracker = function () {
							return new Tracker();
						};
						var Tracker = function () {
							return null;
						};
						var p = Tracker.prototype;
						p.get = noopfn;
						p.set = noopfn;
						p.send = function () {
							var args = Array.prototype.slice.call(arguments);
							args.unshift('send');
							__gaTracker.apply(null, args);
						};
						var __gaTracker = function () {
							var len = arguments.length;
							if (len === 0) {
								return;
							}
							var f = arguments[len - 1];
							if (typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function') {
								if ('send' === arguments[0]) {
									var hitConverted, hitObject = false, action;
									if ('event' === arguments[1]) {
										if ('undefined' !== typeof arguments[3]) {
											hitObject = {
												'eventAction': arguments[3],
												'eventCategory': arguments[2],
												'eventLabel': arguments[4],
												'value': arguments[5] ? arguments[5] : 1,
											}
										}
									}
									if ('pageview' === arguments[1]) {
										if ('undefined' !== typeof arguments[2]) {
											hitObject = {
												'eventAction': 'page_view',
												'page_path': arguments[2],
											}
										}
									}
									if (typeof arguments[2] === 'object') {
										hitObject = arguments[2];
									}
									if (typeof arguments[5] === 'object') {
										Object.assign(hitObject, arguments[5]);
									}
									if ('undefined' !== typeof arguments[1].hitType) {
										hitObject = arguments[1];
										if ('pageview' === hitObject.hitType) {
											hitObject.eventAction = 'page_view';
										}
									}
									if (hitObject) {
										action = 'timing' === arguments[1].hitType ? 'timing_complete' : hitObject.eventAction;
										hitConverted = mapArgs(hitObject);
										__gtagTracker('event', action, hitConverted);
									}
								}
								return;
							}

							function mapArgs(args) {
								var arg, hit = {};
								var gaMap = {
									'eventCategory': 'event_category',
									'eventAction': 'event_action',
									'eventLabel': 'event_label',
									'eventValue': 'event_value',
									'nonInteraction': 'non_interaction',
									'timingCategory': 'event_category',
									'timingVar': 'name',
									'timingValue': 'value',
									'timingLabel': 'event_label',
									'page': 'page_path',
									'location': 'page_location',
									'title': 'page_title',
								};
								for (arg in args) {
																		if (!(!args.hasOwnProperty(arg) || !gaMap.hasOwnProperty(arg))) {
										hit[gaMap[arg]] = args[arg];
									} else {
										hit[arg] = args[arg];
									}
								}
								return hit;
							}

							try {
								f.hitCallback();
							} catch (ex) {
							}
						};
						__gaTracker.create = newtracker;
						__gaTracker.getByName = newtracker;
						__gaTracker.getAll = function () {
							return [];
						};
						__gaTracker.remove = noopfn;
						__gaTracker.loaded = true;
						window['__gaTracker'] = __gaTracker;
					})();
									} else {
										console.log("");
					(function () {
						function __gtagTracker() {
							return null;
						}

						window['__gtagTracker'] = __gtagTracker;
						window['gtag'] = __gtagTracker;
					})();
									}
			</script>
				<!-- / Google Analytics by MonsterInsights -->
		<script type="text/javascript">
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/thinkingneuron.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.3.4"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c\udfff","\ud83e\udef1\ud83c\udffb\u200b\ud83e\udef2\ud83c\udfff")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 0.07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="urvanov_syntax_highlighter-css" href="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/urvanov_syntax_highlighter.min.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-classic-css" href="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/classic.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/monaco.css" type="text/css" media="all">
<link rel="stylesheet" id="astra-theme-css-css" href="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/style.min.css" type="text/css" media="all">
<style id="astra-theme-css-inline-css" type="text/css">
html{font-size:93.75%;}a,.page-title{color:#075aae;}a:hover,a:focus{color:#000000;}body,button,input,select,textarea{font-family:'Montserrat',sans-serif;font-weight:400;font-size:15px;font-size:1rem;}blockquote{border-color:rgba(7,90,174,0.05);}h1,.entry-content h1,.entry-content h1 a,h2,.entry-content h2,.entry-content h2 a,h3,.entry-content h3,.entry-content h3 a,h4,.entry-content h4,.entry-content h4 a,h5,.entry-content h5,.entry-content h5 a,h6,.entry-content h6,.entry-content h6 a,.site-title,.site-title a{font-family:'Montserrat',sans-serif;font-weight:300;}.site-title{font-size:35px;font-size:2.3333333333333rem;}header .site-logo-img .custom-logo-link img{max-width:276px;}.astra-logo-svg{width:276px;}.ast-archive-description .ast-archive-title{font-size:20px;font-size:1.3333333333333rem;}.site-header .site-description{font-size:15px;font-size:1rem;}.entry-title{font-size:30px;font-size:2rem;}.comment-reply-title{font-size:24px;font-size:1.6rem;}.ast-comment-list #cancel-comment-reply-link{font-size:15px;font-size:1rem;}h1,.entry-content h1,.entry-content h1 a{font-size:60px;font-size:4rem;}h2,.entry-content h2,.entry-content h2 a{font-size:40px;font-size:2.6666666666667rem;}h3,.entry-content h3,.entry-content h3 a{font-size:25px;font-size:1.6666666666667rem;}h4,.entry-content h4,.entry-content h4 a{font-size:20px;font-size:1.3333333333333rem;}h5,.entry-content h5,.entry-content h5 a{font-size:15px;font-size:1rem;}h6,.entry-content h6,.entry-content h6 a{font-size:12px;font-size:0.8rem;}.ast-single-post .entry-title,.page-title{font-size:40px;font-size:2.6666666666667rem;}#secondary,#secondary button,#secondary input,#secondary select,#secondary textarea{font-size:15px;font-size:1rem;}::selection{background-color:#075aae;color:#ffffff;}body,h1,.entry-title a,.entry-content h1,.entry-content h1 a,h2,.entry-content h2,.entry-content h2 a,h3,.entry-content h3,.entry-content h3 a,h4,.entry-content h4,.entry-content h4 a,h5,.entry-content h5,.entry-content h5 a,h6,.entry-content h6,.entry-content h6 a{color:#000000;}.tagcloud a:hover,.tagcloud a:focus,.tagcloud a.current-item{color:#ffffff;border-color:#075aae;background-color:#075aae;}.main-header-menu a,.ast-header-custom-item a{color:#000000;}.main-header-menu li:hover > a,.main-header-menu li:hover > .ast-menu-toggle,.main-header-menu .ast-masthead-custom-menu-items a:hover,.main-header-menu li.focus > a,.main-header-menu li.focus > .ast-menu-toggle,.main-header-menu .current-menu-item > a,.main-header-menu .current-menu-ancestor > a,.main-header-menu .current_page_item > a,.main-header-menu .current-menu-item > .ast-menu-toggle,.main-header-menu .current-menu-ancestor > .ast-menu-toggle,.main-header-menu .current_page_item > .ast-menu-toggle{color:#075aae;}input:focus,input[type="text"]:focus,input[type="email"]:focus,input[type="url"]:focus,input[type="password"]:focus,input[type="reset"]:focus,input[type="search"]:focus,textarea:focus{border-color:#075aae;}input[type="radio"]:checked,input[type=reset],input[type="checkbox"]:checked,input[type="checkbox"]:hover:checked,input[type="checkbox"]:focus:checked,input[type=range]::-webkit-slider-thumb{border-color:#075aae;background-color:#075aae;box-shadow:none;}.site-footer a:hover + .post-count,.site-footer a:focus + .post-count{background:#075aae;border-color:#075aae;}.ast-small-footer{color:#000000;}.ast-small-footer > .ast-footer-overlay{background-color:#ffffff;}.ast-small-footer a{color:#075aae;}.ast-small-footer a:hover{color:#000000;}.footer-adv .footer-adv-overlay{border-top-style:solid;border-top-color:#7a7a7a;}.ast-comment-meta{line-height:1.666666667;font-size:12px;font-size:0.8rem;}.single .nav-links .nav-previous,.single .nav-links .nav-next,.single .ast-author-details .author-title,.ast-comment-meta{color:#075aae;}.menu-toggle,button,.ast-button,.button,input#submit,input[type="button"],input[type="submit"],input[type="reset"]{border-radius:0;padding:10px 40px;color:#ffffff;border-color:#075aae;background-color:#075aae;}button:focus,.menu-toggle:hover,button:hover,.ast-button:hover,.button:hover,input[type=reset]:hover,input[type=reset]:focus,input#submit:hover,input#submit:focus,input[type="button"]:hover,input[type="button"]:focus,input[type="submit"]:hover,input[type="submit"]:focus{color:#ffffff;border-color:#075aae;background-color:#075aae;}.entry-meta,.entry-meta *{line-height:1.45;color:#075aae;}.entry-meta a:hover,.entry-meta a:hover *,.entry-meta a:focus,.entry-meta a:focus *{color:#000000;}blockquote,blockquote a{color:#000000;}.ast-404-layout-1 .ast-404-text{font-size:200px;font-size:13.333333333333rem;}.widget-title{font-size:21px;font-size:1.4rem;color:#000000;}#cat option,.secondary .calendar_wrap thead a,.secondary .calendar_wrap thead a:visited{color:#075aae;}.secondary .calendar_wrap #today,.ast-progress-val span{background:#075aae;}.secondary a:hover + .post-count,.secondary a:focus + .post-count{background:#075aae;border-color:#075aae;}.calendar_wrap #today > a{color:#ffffff;}.ast-pagination a,.page-links .page-link,.single .post-navigation a{color:#075aae;}.ast-pagination a:hover,.ast-pagination a:focus,.ast-pagination > span:hover:not(.dots),.ast-pagination > span.current,.page-links > .page-link,.page-links .page-link:hover,.post-navigation a:hover{color:#000000;}.ast-header-break-point .ast-mobile-menu-buttons-minimal.menu-toggle{background:transparent;color:#075aae;}.ast-header-break-point .ast-mobile-menu-buttons-outline.menu-toggle{background:transparent;border:1px solid #075aae;color:#075aae;}.ast-header-break-point .ast-mobile-menu-buttons-fill.menu-toggle{background:#075aae;color:#ffffff;}@media (min-width:545px){.ast-page-builder-template .comments-area,.single.ast-page-builder-template .entry-header,.single.ast-page-builder-template .post-navigation{max-width:1240px;margin-left:auto;margin-right:auto;}}@media (max-width:768px){.ast-archive-description .ast-archive-title{font-size:40px;}.entry-title{font-size:30px;}h1,.entry-content h1,.entry-content h1 a{font-size:35px;}h2,.entry-content h2,.entry-content h2 a{font-size:25px;}h3,.entry-content h3,.entry-content h3 a{font-size:20px;}.ast-single-post .entry-title,.page-title{font-size:30px;}}@media (max-width:544px){.comment-reply-title{font-size:26px;font-size:1.625rem;}.ast-comment-meta{font-size:13px;font-size:0.8125rem;}.widget-title{font-size:22px;font-size:1.375rem;}body,button,input,select,textarea{font-size:16px;font-size:1.0666666666667rem;}.ast-comment-list #cancel-comment-reply-link{font-size:16px;font-size:1.0666666666667rem;}#secondary,#secondary button,#secondary input,#secondary select,#secondary textarea{font-size:16px;font-size:1.0666666666667rem;}.ast-archive-description .ast-archive-title{font-size:15px;}.entry-title{font-size:22px;}h1,.entry-content h1,.entry-content h1 a{font-size:30px;}h2,.entry-content h2,.entry-content h2 a{font-size:25px;}h3,.entry-content h3,.entry-content h3 a{font-size:20px;}.ast-single-post .entry-title,.page-title{font-size:28px;}}@media (max-width:768px){html{font-size:85.5%;}}@media (max-width:544px){html{font-size:93.75%;}}@media (min-width:769px){.ast-container{max-width:1240px;}}@font-face {font-family: "Astra";src: url( https://thinkingneuron.com/wp-content/themes/astra/assets/fonts/astra.woff) format("woff"),url( https://thinkingneuron.com/wp-content/themes/astra/assets/fonts/astra.ttf) format("truetype"),url( https://thinkingneuron.com/wp-content/themes/astra/assets/fonts/astra.svg#astra) format("svg");font-weight: normal;font-style: normal;}@media (max-width:921px) {.main-header-bar .main-header-bar-navigation{display:none;}}@media (min-width:769px){.single-post .site-content > .ast-container{max-width:1100px;}}.ast-desktop .main-header-menu.submenu-with-border .sub-menu,.ast-desktop .main-header-menu.submenu-with-border .children,.ast-desktop .main-header-menu.submenu-with-border .astra-full-megamenu-wrapper{border-color:#eaeaea;}.ast-desktop .main-header-menu.submenu-with-border .sub-menu,.ast-desktop .main-header-menu.submenu-with-border .children{border-top-width:1px;border-right-width:1px;border-left-width:1px;border-bottom-width:1px;border-style:solid;}.ast-desktop .main-header-menu.submenu-with-border .sub-menu .sub-menu,.ast-desktop .main-header-menu.submenu-with-border .children .children{top:-1px;}.ast-desktop .main-header-menu.submenu-with-border .sub-menu a,.ast-desktop .main-header-menu.submenu-with-border .children a{border-bottom-width:1px;border-style:solid;border-color:#eaeaea;}@media (min-width:769px){.main-header-menu .sub-menu li.ast-left-align-sub-menu:hover > ul,.main-header-menu .sub-menu li.ast-left-align-sub-menu.focus > ul{margin-left:-2px;}}.ast-small-footer{border-top-style:solid;border-top-width:1px;border-top-color:#f2f2f2;}.ast-small-footer-wrap{text-align:center;}@media (max-width:920px){.ast-404-layout-1 .ast-404-text{font-size:100px;font-size:6.6666666666667rem;}}
.ast-header-break-point .site-header{border-bottom-width:1px;border-bottom-color:#f2f2f2;}@media (min-width:769px){.main-header-bar{border-bottom-width:1px;border-bottom-color:#f2f2f2;}}.ast-flex{-webkit-align-content:center;-ms-flex-line-pack:center;align-content:center;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;}.main-header-bar{padding:1em 0;}.ast-site-identity{padding:0;}
</style>
<link rel="stylesheet" id="astra-google-fonts-css" href="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/css" type="text/css" media="all">
<link rel="stylesheet" id="wp-block-library-css" href="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/style(1).min.css" type="text/css" media="all">
<style id="classic-theme-styles-inline-css" type="text/css">
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id="global-styles-inline-css" type="text/css">
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}
</style>
<link rel="stylesheet" id="post_grid_style-css" href="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/style-new.css" type="text/css" media="all">
<link rel="stylesheet" id="owl.carousel-css" href="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/owl.carousel.css" type="text/css" media="all">
<link rel="stylesheet" id="font-awesome-css" href="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/font-awesome.min.css" type="text/css" media="all">
<link rel="stylesheet" id="style-woocommerce-css" href="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/style-woocommerce.css" type="text/css" media="all">
<link rel="stylesheet" id="style.skins-css" href="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/style.skins.css" type="text/css" media="all">
<link rel="stylesheet" id="style.layout-css" href="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/style.layout.css" type="text/css" media="all">
<link rel="stylesheet" id="uab-frontend-style-css" href="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/frontend.css" type="text/css" media="all">
<link rel="stylesheet" id="uab-frontend-responsive-style-css" href="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/uab-responsive.css" type="text/css" media="all">
<link rel="stylesheet" id="uab-fontawesome-css" href="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/all.css" type="text/css" media="all">
<link rel="stylesheet" id="google-fonts-css" href="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/css(1)" type="text/css" media="all">
<script type="text/javascript" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/jquery.min.js.下载" id="jquery-core-js"></script>
<script type="text/javascript" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/jquery-migrate.min.js.下载" id="jquery-migrate-js"></script>
<script type="text/javascript" id="urvanov_syntax_highlighter_js-js-extra">
/* <![CDATA[ */
var UrvanovSyntaxHighlighterSyntaxSettings = {"version":"2.8.28","is_admin":"0","ajaxurl":"https:\/\/thinkingneuron.com\/wp-admin\/admin-ajax.php","prefix":"urvanov-syntax-highlighter-","setting":"urvanov-syntax-highlighter-setting","selected":"urvanov-syntax-highlighter-setting-selected","changed":"urvanov-syntax-highlighter-setting-changed","special":"urvanov-syntax-highlighter-setting-special","orig_value":"data-orig-value","debug":""};
var UrvanovSyntaxHighlighterSyntaxStrings = {"copy":"Copied to the clipboard","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/urvanov_syntax_highlighter.min.js.下载" id="urvanov_syntax_highlighter_js-js"></script>
<!--[if IE]>
<script type='text/javascript' src='https://thinkingneuron.com/wp-content/themes/astra/assets/js/minified/flexibility.min.js?ver=1.6.3' id='astra-flexibility-js'></script>
<script id="astra-flexibility-js-after" type="text/javascript">
flexibility(document.documentElement);
</script>
<![endif]-->
<script type="text/javascript" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/frontend-gtag.min.js.下载" id="monsterinsights-frontend-script-js"></script>
<script data-cfasync="false" data-wpfc-render="false" type="text/javascript" id="monsterinsights-frontend-script-js-extra">/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,pdf,ppt,zip,xls,docx,pptx,xlsx","inbound_paths":"[{\"path\":\"\\\/go\\\/\",\"label\":\"affiliate\"},{\"path\":\"\\\/recommend\\\/\",\"label\":\"affiliate\"}]","home_url":"https:\/\/thinkingneuron.com","hash_tracking":"false","v4_id":"G-Z3542E8PKD"};/* ]]> */
</script>
<script type="text/javascript" id="post_grid_scripts-js-extra">
/* <![CDATA[ */
var post_grid_ajax = {"post_grid_ajaxurl":"https:\/\/thinkingneuron.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type="text/javascript" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/scripts.js.下载" id="post_grid_scripts-js"></script>
<script type="text/javascript" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/owl.carousel.min.js.下载" id="owl.carousel.min-js"></script>
<script type="text/javascript" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/all.js.下载" id="uab-fontawesome-js"></script>
<script type="text/javascript" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/frontend.js.下载" id="uab-frontend-script-js"></script>
<link rel="https://api.w.org/" href="https://thinkingneuron.com/wp-json/"><link rel="alternate" type="application/json" href="https://thinkingneuron.com/wp-json/wp/v2/posts/3266"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://thinkingneuron.com/xmlrpc.php?rsd">
<meta name="generator" content="WordPress 6.3.4">
<link rel="shortlink" href="https://thinkingneuron.com/?p=3266">
<link rel="alternate" type="application/json+oembed" href="https://thinkingneuron.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthinkingneuron.com%2Fpredicting-stock-prices-using-deep-learning-lstm-model-in-python%2F">
<link rel="alternate" type="text/xml+oembed" href="https://thinkingneuron.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fthinkingneuron.com%2Fpredicting-stock-prices-using-deep-learning-lstm-model-in-python%2F&amp;format=xml">
<link rel="pingback" href="https://thinkingneuron.com/xmlrpc.php">
<link rel="icon" href="https://thinkingneuron.com/wp-content/uploads/2021/05/cropped-Logo-TN-Black-PNBG-32x32.png" sizes="32x32">
<link rel="icon" href="https://thinkingneuron.com/wp-content/uploads/2021/05/cropped-Logo-TN-Black-PNBG-192x192.png" sizes="192x192">
<link rel="apple-touch-icon" href="https://thinkingneuron.com/wp-content/uploads/2021/05/cropped-Logo-TN-Black-PNBG-180x180.png">
<meta name="msapplication-TileImage" content="https://thinkingneuron.com/wp-content/uploads/2021/05/cropped-Logo-TN-Black-PNBG-270x270.png">
<style id="wpforms-css-vars-root">
				:root {
					--wpforms-field-border-radius: 3px;
--wpforms-field-background-color: #ffffff;
--wpforms-field-border-color: rgba( 0, 0, 0, 0.25 );
--wpforms-field-text-color: rgba( 0, 0, 0, 0.7 );
--wpforms-label-color: rgba( 0, 0, 0, 0.85 );
--wpforms-label-sublabel-color: rgba( 0, 0, 0, 0.55 );
--wpforms-label-error-color: #d63637;
--wpforms-button-border-radius: 3px;
--wpforms-button-background-color: #066aab;
--wpforms-button-text-color: #ffffff;
--wpforms-field-size-input-height: 43px;
--wpforms-field-size-input-spacing: 15px;
--wpforms-field-size-font-size: 16px;
--wpforms-field-size-line-height: 19px;
--wpforms-field-size-padding-h: 14px;
--wpforms-field-size-checkbox-size: 16px;
--wpforms-field-size-sublabel-spacing: 5px;
--wpforms-field-size-icon-size: 1;
--wpforms-label-size-font-size: 16px;
--wpforms-label-size-line-height: 19px;
--wpforms-label-size-sublabel-font-size: 14px;
--wpforms-label-size-sublabel-line-height: 17px;
--wpforms-button-size-font-size: 17px;
--wpforms-button-size-height: 41px;
--wpforms-button-size-padding-h: 15px;
--wpforms-button-size-margin-top: 10px;

				}
			</style><script src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/wp-emoji-release.min.js.下载" defer=""></script><link type="text/css" rel="stylesheet" charset="UTF-8" href="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/m=el_main_css"></head>

<body itemtype="https://schema.org/Blog" itemscope="itemscope" class="post-template-default single single-post postid-3266 single-format-standard wp-custom-logo ast-desktop ast-separate-container ast-two-container ast-no-sidebar astra-1.6.3 ast-header-custom-item-inside ast-blog-single-style-1 ast-single-post ast-inherit-site-logo-transparent ast-normal-title-enabled elementor-default" style="" data-new-gr-c-s-check-loaded="14.1172.0" data-gr-ext-installed="" data-new-gr-c-s-loaded="14.1172.0">

<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#content">Skip to content</a>

	
	
		<header itemtype="https://schema.org/WPHeader" itemscope="itemscope" id="masthead" class="site-header header-main-layout-1 ast-primary-menu-enabled ast-has-mobile-header-logo ast-hide-custom-menu-mobile ast-menu-toggle-icon ast-mobile-header-inline" role="banner">

			
			
<div class="main-header-bar-wrap">
	<div class="main-header-bar">
				<div class="ast-container">

			<div class="ast-flex main-header-container">
				
		<div class="site-branding">
			<div class="ast-site-identity" itemscope="itemscope" itemtype="https://schema.org/Organization">
				<span class="site-logo-img"><a href="https://thinkingneuron.com/" class="custom-logo-link" rel="home"><img width="276" height="41" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/Logo-Thinking-Neuron-Black-276x41.png" class="custom-logo" alt="Thinking Neuron banner Logo" decoding="async" srcset="https://thinkingneuron.com/wp-content/uploads/2021/05/Logo-Thinking-Neuron-Black-276x41.png 1x, https://thinkingneuron.com/wp-content/uploads/2021/05/Logo-Thinking-Neuron-Black.png 2x" sizes="(max-width: 276px) 100vw, 276px"></a><a href="https://thinkingneuron.com/" class="custom-mobile-logo-link" rel="home" itemprop="url"><img width="4939" height="741" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/Logo-Thinking-Neuron-Black-276x41.png" class="ast-mobile-header-logo" alt="Thinking Neuron banner Logo" decoding="async" fetchpriority="high" srcset="https://thinkingneuron.com/wp-content/uploads/2021/05/Logo-Thinking-Neuron-Black-276x41.png 1x, https://thinkingneuron.com/wp-content/uploads/2021/05/Logo-Thinking-Neuron-Black.png 2x" sizes="(max-width: 4939px) 100vw, 4939px"></a></span>			</div>
		</div>

		<!-- .site-branding -->
				<div class="ast-mobile-menu-buttons">

			
					<div class="ast-button-wrap">
			<button type="button" class="menu-toggle main-header-menu-toggle ast-mobile-menu-buttons-fill" rel="main-menu" aria-controls="primary-menu" aria-expanded="false" data-index="0">
				<span class="screen-reader-text">Main Menu</span>
				<span class="menu-toggle-icon"></span>
							</button>
		</div>
			
			
		</div>
			<div class="ast-main-header-bar-alignment"><div class="main-header-bar-navigation"><nav itemtype="https://schema.org/SiteNavigationElement" itemscope="itemscope" id="site-navigation" class="ast-flex-grow-1" role="navigation" aria-label="Site Navigation"><div class="main-navigation"><ul id="primary-menu" class="main-header-menu ast-nav-menu ast-flex ast-justify-content-flex-end  submenu-with-border" aria-expanded="false"><li id="menu-item-3676" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3676"><a href="https://thinkingneuron.com/python-case-studies/">Python Case Studies</a></li>
<li id="menu-item-3441" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3441"><a href="https://thinkingneuron.com/category/data-science-interview-questions/">Data Science Interview Questions</a></li>
<li id="menu-item-3437" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-3437" aria-haspopup="true"><a href="https://thinkingneuron.com/python-ai-ml/">AI/ML</a><button role="button" class="ast-menu-toggle" aria-expanded="false"><span class="screen-reader-text">Menu Toggle</span></button>
<ul class="sub-menu">
	<li id="menu-item-3442" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-3442"><a href="https://thinkingneuron.com/category/deep-learning/">Deep Learning</a></li>
	<li id="menu-item-3443" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3443"><a href="https://thinkingneuron.com/category/machine-learning/">Machine Learning</a></li>
	<li id="menu-item-3439" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3439"><a href="https://thinkingneuron.com/python-case-studies/">Python Case Studies</a></li>
	<li id="menu-item-3440" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3440"><a href="https://thinkingneuron.com/python-programming/">Python Programming for Data Science</a></li>
	<li id="menu-item-3444" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3444"><a href="https://thinkingneuron.com/category/supervised-machine-learning/">Supervised Machine Learning</a></li>
	<li id="menu-item-3445" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3445"><a href="https://thinkingneuron.com/category/unsupervised-machine-learning/">Unsupervised Machine Learning</a></li>
	<li id="menu-item-3446" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-3446"><a href="https://thinkingneuron.com/category/text-mining/">Text Mining</a></li>
</ul>
</li>
<li id="menu-item-3438" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3438"><a href="https://thinkingneuron.com/blogs/">Blogs</a></li>
			<li class="ast-masthead-custom-menu-items search-custom-menu-item">
						<div class="ast-search-menu-icon slide-search" id="ast-search-form">
			<div class="ast-search-icon">
				<a class="slide-search astra-search-icon" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#">
					<span class="screen-reader-text">Search</span>
				</a>
			</div>
			<form role="search" method="get" class="search-form" action="https://thinkingneuron.com/">
			<label>
				<span class="screen-reader-text">Search for:</span>
				<input type="search" class="search-field" placeholder="Search …" value="" name="s">
			</label>
			<button type="submit" class="search-submit" value="Search"><i class="astra-search-icon"></i></button>
		</form>		</div>
					</li>
			</ul></div></nav></div></div>			</div><!-- Main Header Container -->
		</div><!-- ast-row -->
			</div> <!-- Main Header Bar -->
</div> <!-- Main Header Bar Wrap -->

			
		</header><!-- #masthead -->
		
	
	
	<div id="content" class="site-content">

		<div class="ast-container">

		

	<div id="primary" class="content-area primary">
				<div class="breadcrumb"><a href="https://thinkingneuron.com/" rel="nofollow">Home</a>&nbsp;&nbsp;»&nbsp;&nbsp;<a href="https://thinkingneuron.com/category/blog/" rel="category tag">Blog</a> • <a href="https://thinkingneuron.com/category/case-studies-python/" rel="category tag">Case Studies-Python</a> • <a href="https://thinkingneuron.com/category/deep-learning/" rel="category tag">Deep Learning</a> &nbsp;&nbsp;»&nbsp;&nbsp; Predicting stock prices using Deep Learning LSTM model in Python</div>
					<main id="main" class="site-main" role="main">

				
					
					

<article itemtype="https://schema.org/CreativeWork" itemscope="itemscope" id="post-3266" class="post-3266 post type-post status-publish format-standard has-post-thumbnail hentry category-blog category-case-studies-python category-deep-learning tag-deep-learning tag-lstm tag-python-case-study tag-stock-price-prediction ast-article-single">

		
<div class="ast-post-format- single-layout-1">

	
	<header class="entry-header ">

		
				<div class="ast-single-post-order">
			<h1 class="entry-title" itemprop="headline">Predicting stock prices using Deep Learning LSTM model in Python</h1><div class="entry-meta"><span class="cat-links"><a href="https://thinkingneuron.com/category/blog/" rel="category tag">Blog</a>, <a href="https://thinkingneuron.com/category/case-studies-python/" rel="category tag">Case Studies-Python</a>, <a href="https://thinkingneuron.com/category/deep-learning/" rel="category tag">Deep Learning</a></span> / 			<span class="comments-link">
				<a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comments">42 Comments</a>
				<!-- Comment Schema Meta -->
				<span itemprop="interactionStatistic" itemscope="" itemtype="https://schema.org/InteractionCounter">
					<meta itemprop="interactionType" content="https://schema.org/CommentAction">
					<meta itemprop="userInteractionCount" content="42">
				</span>
			</span>

			 / By 
		<span class="posted-by vcard author" itemtype="https://schema.org/Person" itemscope="itemscope" itemprop="author">
						<a class="url fn n" title="View all posts by Farukh Hashmi" href="https://thinkingneuron.com/author/admin/" rel="author" itemprop="url">
				<span class="author-name" itemprop="name">Farukh Hashmi</span>
			</a>
		</span>

		</div>		</div>
		<div class="post-thumb-img-content post-thumb"><img width="1000" height="361" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/LSTM-architechture.png" class="attachment-large size-large wp-post-image" alt="LSTM architecture" decoding="async" itemprop="image" srcset="https://thinkingneuron.com/wp-content/uploads/2020/10/LSTM-architechture.png 1000w, https://thinkingneuron.com/wp-content/uploads/2020/10/LSTM-architechture-300x108.png 300w, https://thinkingneuron.com/wp-content/uploads/2020/10/LSTM-architechture-768x277.png 768w" sizes="(max-width: 1000px) 100vw, 1000px"></div>
		
	</header><!-- .entry-header -->

	
	<div class="entry-content clear" itemprop="text">

		
		<p></p>
<p>Long Short Term Memory(LSTM) is a special type of Recurrent Neural Network(RNN) which can retain important information over time using memory cells. </p>
<p></p>
<p></p>
<p>This property of LSTMs makes it a wonderful algorithm to learn sequences that are interdependent and can help to build solutions like language translation, sales time series, chatbots, autocorrections, next word suggestions, etc.</p>
<p></p>
<p></p>
<p>You can read more about <a href="https://thinkingneuron.com/data-science-interview-questions-deep-learning/#What-is-a-Long-Short-Term-Memory-Network(LSTM)" target="_blank" rel="noreferrer noopener">LSTMs here</a>.</p>
<p></p>
<p></p>
<p>In this case study, I will show how LSTMs can be used to learn the patterns in the stock prices. Using this template you will be able to predict tomorrow’s price of a stock based on the last 10 days prices.</p>
<p></p>
<p></p>
<hr class="wp-block-separator is-style-wide">
<p></p>
<p></p>
<h3 class="wp-block-heading"><strong>Pulling historical stock prices data</strong></h3>
<p></p>
<p></p>
<p>To pull the data for any stock we can use a library named ‘<strong>nsepy</strong>‘</p>
<p></p>
<p></p>
<p>If you want to do this for any other stock, just use the stock market ticker symbol for that company like I have used ‘INFY’ for Infosys here.</p>
<p></p>
<p></p><!-- Urvanov Syntax Highlighter v2.8.28 -->

		<div id="urvanov-syntax-highlighter-6640e6321dd5a886314479" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -17.994px; position: absolute; z-index: 2; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -16.7969px; display: none;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden; height: 314.894px; display: inline-block;">import pandas as pd
import numpy as np

# To remove the scientific notation from numpy arrays
np.set_printoptions(suppress=True)

# install the nsepy library to get stock prices
!pip install nsepy

############################################
# Getting Stock data using nsepy library
from nsepy import get_history
from datetime import datetime

startDate=datetime(2019, 1,1)
endDate=datetime(2020, 10, 5)

# Fetching the data
StockData=get_history(symbol='INFY', start=startDate, end=endDate)
print(StockData.shape)
StockData.head()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden; opacity: 1;">
				<table class="crayon-table" style="margin-left: -25px;">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd5a886314479-21">21</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-1"><span class="crayon-e">import </span><span class="crayon-e">pandas </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">pd</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-2"><span class="crayon-e">import </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-i">np</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-4"><span class="crayon-p"># To remove the scientific notation from numpy arrays</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-5"><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">set_printoptions</span><span class="crayon-sy">(</span><span class="crayon-v">suppress</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-7"><span class="crayon-p"># install the nsepy library to get stock prices</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-8"><span class="crayon-o">!</span><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-i">nsepy</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-10"><span class="crayon-p">############################################</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-11"><span class="crayon-p"># Getting Stock data using nsepy library</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-12"><span class="crayon-e">from </span><span class="crayon-e">nsepy </span><span class="crayon-e">import </span><span class="crayon-e">get_history</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-13"><span class="crayon-e">from </span><span class="crayon-e">datetime </span><span class="crayon-e">import </span><span class="crayon-e">datetime</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-15"><span class="crayon-v">startDate</span><span class="crayon-o">=</span><span class="crayon-e">datetime</span><span class="crayon-sy">(</span><span class="crayon-cn">2019</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-16"><span class="crayon-v">endDate</span><span class="crayon-o">=</span><span class="crayon-e">datetime</span><span class="crayon-sy">(</span><span class="crayon-cn">2020</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-18"><span class="crayon-p"># Fetching the data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-19"><span class="crayon-v">StockData</span><span class="crayon-o">=</span><span class="crayon-e">get_history</span><span class="crayon-sy">(</span><span class="crayon-v">symbol</span><span class="crayon-o">=</span><span class="crayon-s">'INFY'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">start</span><span class="crayon-o">=</span><span class="crayon-v">startDate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-st">end</span><span class="crayon-o">=</span><span class="crayon-v">endDate</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-20"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">StockData</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd5a886314479-21"><span class="crayon-v">StockData</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0020 seconds] -->
<p></p>
<p></p>
<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="989" height="343" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-18.png" alt="Historical stock prices for Infosys" class="wp-image-3267" srcset="https://thinkingneuron.com/wp-content/uploads/2020/10/image-18.png 989w, https://thinkingneuron.com/wp-content/uploads/2020/10/image-18-300x104.png 300w, https://thinkingneuron.com/wp-content/uploads/2020/10/image-18-768x266.png 768w" sizes="(max-width: 989px) 100vw, 989px"></figure>
<p></p>
<p></p>
<hr class="wp-block-separator is-style-wide">
<p></p>
<p></p>
<h3 class="wp-block-heading"><strong>Visualizing the stock prices movement</strong></h3>
<p></p>
<p></p><!-- Urvanov Syntax Highlighter v2.8.28 -->

		<div id="urvanov-syntax-highlighter-6640e6321dd64017656892" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -17.994px; position: absolute; z-index: 2; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="urvanov-syntax-highlighter-mixed-highlight" title="Contains Mixed Languages"></span><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Creating a column as date
StockData['TradeDate']=StockData.index

# Plotting the stock prices
%matplotlib inline
StockData.plot(x='TradeDate', y='Close', kind='line', figsize=(20,6), rot=20)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd64017656892-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd64017656892-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd64017656892-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd64017656892-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd64017656892-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd64017656892-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd64017656892-1"><span class="crayon-p"># Creating a column as date</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd64017656892-2"><span class="crayon-v">StockData</span><span class="crayon-sy">[</span><span class="crayon-s">'TradeDate'</span><span class="crayon-sy">]</span><span class="crayon-o">=</span><span class="crayon-v">StockData</span><span class="crayon-sy">.</span><span class="crayon-i">index</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd64017656892-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd64017656892-4"><span class="crayon-p"># Plotting the stock prices</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd64017656892-5"><span class="crayon-ta">%</span><span class="crayon-i">matplotlib</span><span class="crayon-h"> </span><span class="crayon-i">inline</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd64017656892-6"><span class="crayon-v">StockData</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">=</span><span class="crayon-s">'TradeDate'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-o">=</span><span class="crayon-s">'Close'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kind</span><span class="crayon-o">=</span><span class="crayon-s">'line'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">figsize</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rot</span><span class="crayon-o">=</span><span class="crayon-cn">20</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0069 seconds] -->
<p></p>
<p></p>
<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="970" height="321" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-19.png" alt="Stock prices of Infosys for last two years to be used in training of LSTM model" class="wp-image-3269" srcset="https://thinkingneuron.com/wp-content/uploads/2020/10/image-19.png 970w, https://thinkingneuron.com/wp-content/uploads/2020/10/image-19-300x99.png 300w, https://thinkingneuron.com/wp-content/uploads/2020/10/image-19-768x254.png 768w" sizes="(max-width: 970px) 100vw, 970px"></figure>
<p></p>
<p></p>
<hr class="wp-block-separator is-style-wide">
<p></p>
<p></p>
<h3 class="wp-block-heading"><strong>Preparing the data </strong></h3>
<p></p>
<p></p>
<p>The LSTM model will need data input in the form of X Vs y. Where the X will represent the last 10 day’s prices and y will represent the 11th-day price.</p>
<p></p>
<p></p>
<p>By looking at a lot of such examples from the past 2 years, the LSTM will be able to learn the movement of prices. Hence, when we pass the last 10 days of the price it will be able to predict tomorrow’s stock close price.</p>
<p></p>
<p></p>
<p>Since LSTM is a Neural network-based algorithm, standardizing or normalizing the data is mandatory for a fast and more accurate fit.</p>
<p></p>
<p></p><!-- Urvanov Syntax Highlighter v2.8.28 -->

		<div id="urvanov-syntax-highlighter-6640e6321dd66049682973" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -17.994px; position: absolute; z-index: 2; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Extracting the closing prices of each day
FullData=StockData[['Close']].values
print(FullData[0:5])

# Feature Scaling for fast training of neural networks
from sklearn.preprocessing import StandardScaler, MinMaxScaler

# Choosing between Standardization or normalization
#sc = StandardScaler()
sc=MinMaxScaler()

DataScaler = sc.fit(FullData)
X=DataScaler.transform(FullData)
#X=FullData

print('### After Normalization ###')
X[0:5]</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd66049682973-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd66049682973-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd66049682973-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd66049682973-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd66049682973-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd66049682973-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd66049682973-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd66049682973-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd66049682973-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd66049682973-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd66049682973-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd66049682973-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd66049682973-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd66049682973-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd66049682973-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd66049682973-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd66049682973-17">17</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd66049682973-1"><span class="crayon-p"># Extracting the closing prices of each day</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd66049682973-2"><span class="crayon-v">FullData</span><span class="crayon-o">=</span><span class="crayon-v">StockData</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-s">'Close'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">values</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd66049682973-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">FullData</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd66049682973-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd66049682973-5"><span class="crayon-p"># Feature Scaling for fast training of neural networks</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd66049682973-6"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-v">StandardScaler</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">MinMaxScaler</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd66049682973-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd66049682973-8"><span class="crayon-p"># Choosing between Standardization or normalization</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd66049682973-9"><span class="crayon-p">#sc = StandardScaler()</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd66049682973-10"><span class="crayon-v">sc</span><span class="crayon-o">=</span><span class="crayon-e">MinMaxScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd66049682973-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd66049682973-12"><span class="crayon-v">DataScaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sc</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">FullData</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd66049682973-13"><span class="crayon-v">X</span><span class="crayon-o">=</span><span class="crayon-v">DataScaler</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">FullData</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd66049682973-14"><span class="crayon-p">#X=FullData</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd66049682973-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd66049682973-16"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'### After Normalization ###'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd66049682973-17"><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<p></p>
<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="270" height="263" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-20.png" alt="" class="wp-image-3270"></figure>
<p></p>
<p></p>
<hr class="wp-block-separator is-style-wide">
<p></p>
<p></p>
<h3 class="wp-block-heading"><strong>Preparing the data for LSTM</strong></h3>
<p></p>
<p></p><!-- Urvanov Syntax Highlighter v2.8.28 -->

		<div id="urvanov-syntax-highlighter-6640e6321dd68446231318" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -17.994px; position: absolute; z-index: 2; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -16.7969px; display: none;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># split into samples
X_samples = list()
y_samples = list()

NumerOfRows = len(X)
TimeSteps=10  # next day's Price Prediction is based on last how many past day's prices

# Iterate thru the values to create combinations
for i in range(TimeSteps , NumerOfRows , 1):
    x_sample = X[i-TimeSteps:i]
    y_sample = X[i]
    X_samples.append(x_sample)
    y_samples.append(y_sample)

################################################
# Reshape the Input as a 3D (number of samples, Time Steps, Features)
X_data=np.array(X_samples)
X_data=X_data.reshape(X_data.shape[0],X_data.shape[1], 1)
print('\n#### Input Data shape ####')
print(X_data.shape)

# We do not reshape y as a 3D data  as it is supposed to be a single column only
y_data=np.array(y_samples)
y_data=y_data.reshape(y_data.shape[0], 1)
print('\n#### Output Data shape ####')
print(y_data.shape)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd68446231318-26">26</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-1"><span class="crayon-p"># split into samples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-2"><span class="crayon-v">X_samples</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-3"><span class="crayon-v">y_samples</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-5"><span class="crayon-v">NumerOfRows</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-6"><span class="crayon-v">TimeSteps</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-p"># next day's Price Prediction is based on last how many past day's prices</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-8"><span class="crayon-p"># Iterate thru the values to create combinations</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-9"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-i">TimeSteps</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">NumerOfRows</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x_sample</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">-</span><span class="crayon-v">TimeSteps</span><span class="crayon-o">:</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">y_sample</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">X_samples</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">x_sample</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">y_samples</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">y_sample</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-15"><span class="crayon-p">################################################</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-16"><span class="crayon-p"># Reshape the Input as a 3D (number of samples, Time Steps, Features)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-17"><span class="crayon-v">X_data</span><span class="crayon-o">=</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-18"><span class="crayon-v">X_data</span><span class="crayon-o">=</span><span class="crayon-v">X_data</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X_data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-v">X_data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-19"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'\n#### Input Data shape ####'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-20"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">X_data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-22"><span class="crayon-p"># We do not reshape y as a 3D data&nbsp;&nbsp;as it is supposed to be a single column only</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-23"><span class="crayon-v">y_data</span><span class="crayon-o">=</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-24"><span class="crayon-v">y_data</span><span class="crayon-o">=</span><span class="crayon-v">y_data</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">y_data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-25"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'\n#### Output Data shape ####'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd68446231318-26"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">y_data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0013 seconds] -->
<p></p>
<p></p>
<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="272" height="115" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-23.png" alt="Getting data ready for LSTM" class="wp-image-3273"></figure>
<p></p>
<p></p>
<hr class="wp-block-separator is-style-wide">
<p></p>
<p></p>
<h3 class="wp-block-heading"><strong>Splitting the data into training and testing</strong></h3>
<p></p>
<p></p>
<p>Keeping last few days of data to test the learnings of the model and rest for training the model.</p>
<p></p>
<p></p>
<p>Here I am choosing Last 5 days as testing.</p>
<p></p>
<p></p><!-- Urvanov Syntax Highlighter v2.8.28 -->

		<div id="urvanov-syntax-highlighter-6640e6321dd6a364304755" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -17.994px; position: absolute; z-index: 2; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Choosing the number of testing data records
TestingRecords=5

# Splitting the data into train and test
X_train=X_data[:-TestingRecords]
X_test=X_data[-TestingRecords:]
y_train=y_data[:-TestingRecords]
y_test=y_data[-TestingRecords:]

############################################

# Printing the shape of training and testing
print('\n#### Training Data shape ####')
print(X_train.shape)
print(y_train.shape)
print('\n#### Testing Data shape ####')
print(X_test.shape)
print(y_test.shape)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6a364304755-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6a364304755-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6a364304755-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6a364304755-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6a364304755-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6a364304755-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6a364304755-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6a364304755-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6a364304755-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6a364304755-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6a364304755-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6a364304755-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6a364304755-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6a364304755-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6a364304755-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6a364304755-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6a364304755-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6a364304755-18">18</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6a364304755-1"><span class="crayon-p"># Choosing the number of testing data records</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6a364304755-2"><span class="crayon-v">TestingRecords</span><span class="crayon-o">=</span><span class="crayon-cn">5</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6a364304755-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6a364304755-4"><span class="crayon-p"># Splitting the data into train and test</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6a364304755-5"><span class="crayon-v">X_train</span><span class="crayon-o">=</span><span class="crayon-v">X_data</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-v">TestingRecords</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6a364304755-6"><span class="crayon-v">X_test</span><span class="crayon-o">=</span><span class="crayon-v">X_data</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">TestingRecords</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6a364304755-7"><span class="crayon-v">y_train</span><span class="crayon-o">=</span><span class="crayon-v">y_data</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-v">TestingRecords</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6a364304755-8"><span class="crayon-v">y_test</span><span class="crayon-o">=</span><span class="crayon-v">y_data</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">TestingRecords</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6a364304755-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6a364304755-10"><span class="crayon-p">############################################</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6a364304755-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6a364304755-12"><span class="crayon-p"># Printing the shape of training and testing</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6a364304755-13"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'\n#### Training Data shape ####'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6a364304755-14"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6a364304755-15"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">y_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6a364304755-16"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'\n#### Testing Data shape ####'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6a364304755-17"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6a364304755-18"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<p></p>
<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="289" height="158" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-24.png" alt="Splitting the data into training and testing for LSTM" class="wp-image-3276"></figure>
<p></p>
<p></p>
<hr class="wp-block-separator is-style-wide">
<p></p>
<p></p>
<h3 class="wp-block-heading"><strong>Visualizing the input and output data for LSTM</strong></h3>
<p></p>
<p></p>
<p>Printing some sample input and output values to help you visualize how the LSTM model will learn the prices.</p>
<p></p>
<p></p>
<p>You can see the input is a 3D array of the last 10 prices and the output is a 1D array of the next price.</p>
<p></p>
<p></p><!-- Urvanov Syntax Highlighter v2.8.28 -->

		<div id="urvanov-syntax-highlighter-6640e6321dd6b242633939" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -17.994px; position: absolute; z-index: 2; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Visualizing the input and output being sent to the LSTM model
for inp, out in zip(X_train[0:2], y_train[0:2]):
    print(inp,'--', out)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6b242633939-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6b242633939-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6b242633939-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6b242633939-1"><span class="crayon-p"># Visualizing the input and output being sent to the LSTM model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6b242633939-2"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">inp</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">out </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6b242633939-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">inp</span><span class="crayon-sy">,</span><span class="crayon-s">'--'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">out</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p></p>
<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="350" height="447" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-25.png" alt="Sample input and output values for LSTM" class="wp-image-3278" srcset="https://thinkingneuron.com/wp-content/uploads/2020/10/image-25.png 350w, https://thinkingneuron.com/wp-content/uploads/2020/10/image-25-235x300.png 235w" sizes="(max-width: 350px) 100vw, 350px"></figure>
<p></p>
<p></p>
<hr class="wp-block-separator is-style-wide">
<p></p>
<p></p>
<h3 class="wp-block-heading"><strong>Creating the Deep Learning LSTM model</strong></h3>
<p></p>
<p></p>
<p>Look at the use of the LSTM function instead of Dense to define the hidden layers. The output layer has one neuron as we are predicting the next day price, if you want to predict for multiple days, then change the input data and neurons equal to the number of days of forecast.</p>
<p></p>
<p></p><!-- Urvanov Syntax Highlighter v2.8.28 -->

		<div id="urvanov-syntax-highlighter-6640e6321dd6d652892153" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -17.994px; position: absolute; z-index: 2; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Defining Input shapes for LSTM
TimeSteps=X_train.shape[1]
TotalFeatures=X_train.shape[2]
print("Number of TimeSteps:", TimeSteps)
print("Number of Features:", TotalFeatures)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6d652892153-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6d652892153-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6d652892153-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6d652892153-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6d652892153-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6d652892153-1"><span class="crayon-p"># Defining Input shapes for LSTM</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6d652892153-2"><span class="crayon-v">TimeSteps</span><span class="crayon-o">=</span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6d652892153-3"><span class="crayon-v">TotalFeatures</span><span class="crayon-o">=</span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6d652892153-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Number of TimeSteps:"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">TimeSteps</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6d652892153-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Number of Features:"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">TotalFeatures</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p></p>
<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="229" height="42" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-26.png" alt="" class="wp-image-3281"></figure>
<p></p>
<p></p>
<p>In the below code snippet I have used three hidden LSTM layers and one output layer. You can choose more layers if you don’t get accuracy for your data. Similarly you can increase or decrease the number of neurons in the hidden layer.</p>
<p></p>
<p></p>
<p>Just keep in mind, the more neurons and layers you use, the slower the model becomes. Because now there are many more computations to be done.</p>
<p></p>
<p></p>
<p>Each layer has some hyperparameters which needs to be tuned.</p>
<p></p>
<p></p>
<p>Take a look at some of the important hyperparameters of LSTM below</p>
<p></p>
<p></p>
<ul id="block-2cc284b8-bd78-4b2b-8b21-015da7205093">
<li><strong>units</strong>=10: This means we are creating a layer with ten neurons in it. Each of these five neurons will be receiving the values of inputs.</li>
<li><strong>input_shape = (TimeSteps, TotalFeatures)</strong>: The input expected by LSTM is in 3D format. Our training data has a shape of (420, 10, 1) this is in the form of (number of samples, time steps, number of features). This means we have 420 examples to learn in training data, each example looks back 10-steps in time like what was the stock price yesterday, the day before yesterday so on till last 10 days. This is known as Time steps. The last number ‘1’ represents the number of features. Here we are using just one column ‘Closing Stock Price’ hence its equal to ‘1’</li>
<li><strong>kernel_initializer=’uniform’</strong>: When the Neurons start their computation, some algorithm has to decide the value for each weight. This parameter specifies that. You can choose different values for it like ‘normal’ or ‘glorot_uniform’.</li>
<li><strong>activation=’relu’</strong>: This specifies the activation function for the calculations inside each neuron. You can choose values like ‘relu’, ‘tanh’, ‘sigmoid’, etc.</li>
<li><strong>return_sequences=True: </strong>LSTMs backpropagate thru time, hence they return the values of the output from each time step to the next hidden layer. This keeps the expected input of the next hidden layer in the 3D format. This parameter is False for the last hidden layer because now it does not have to return a 3D output to the final Dense layer.</li>
<li><strong>optimizer=’adam’:&nbsp;</strong>This parameter helps to find the optimum values of each weight in the neural network. ‘adam’ is one of the most useful optimizers, another one is ‘rmsprop’</li>
<li><strong>batch_size=10</strong>: This specifies how many rows will be passed to the Network in one go after which the SSE calculation will begin and the neural network will start adjusting its weights based on the errors.<br>When all the rows are passed in the batches of 10 rows each as specified in this parameter, then we call that 1-epoch. Or one full data cycle. This is also known as mini-batch gradient descent. A small value of batch_size will make the LSTM look at the data slowly, like 2 rows at a time or 4 rows at a time which could lead to overfitting, as compared to a large value like 20 or 50 rows at a time, which will make the LSTM look at the data fast which could lead to underfitting. Hence a proper value must be chosen using hyperparameter tuning.</li>
<li><strong>Epochs=10</strong>: The same activity of adjusting weights continues for 10 times, as specified by this parameter. In simple terms, the LSTM looks at the full training data 10 times and adjusts its weights.</li>
</ul>
<p></p>
<p></p><!-- Urvanov Syntax Highlighter v2.8.28 -->

		<div id="urvanov-syntax-highlighter-6640e6321dd6f258974663" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -17.994px; position: absolute; z-index: 2; display: none;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Importing the Keras libraries and packages
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM

# Initialising the RNN
regressor = Sequential()

# Adding the First input hidden layer and the LSTM layer
# return_sequences = True, means the output of every time step to be shared with hidden next layer
regressor.add(LSTM(units = 10, activation = 'relu', input_shape = (TimeSteps, TotalFeatures), return_sequences=True))

# Adding the Second Second hidden layer and the LSTM layer
regressor.add(LSTM(units = 5, activation = 'relu', input_shape = (TimeSteps, TotalFeatures), return_sequences=True))

# Adding the Second Third hidden layer and the LSTM layer
regressor.add(LSTM(units = 5, activation = 'relu', return_sequences=False ))


# Adding the output layer
regressor.add(Dense(units = 1))

# Compiling the RNN
regressor.compile(optimizer = 'adam', loss = 'mean_squared_error')

##################################################

import time
# Measuring the time taken by the model to train
StartTime=time.time()

# Fitting the RNN to the Training set
regressor.fit(X_train, y_train, batch_size = 5, epochs = 100)

EndTime=time.time()
print("## Total Time Taken: ", round((EndTime-StartTime)/60), 'Minutes ##')</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd6f258974663-36">36</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-1"><span class="crayon-p"># Importing the Keras libraries and packages</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-i">LSTM</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-6"><span class="crayon-p"># Initialising the RNN</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-7"><span class="crayon-v">regressor</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-9"><span class="crayon-p"># Adding the First input hidden layer and the LSTM layer</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-10"><span class="crayon-p"># return_sequences = True, means the output of every time step to be shared with hidden next layer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-11"><span class="crayon-v">regressor</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-v">units</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">TimeSteps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">TotalFeatures</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-12">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-13"><span class="crayon-p"># Adding the Second Second hidden layer and the LSTM layer</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-14"><span class="crayon-v">regressor</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-v">units</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">TimeSteps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">TotalFeatures</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-16"><span class="crayon-p"># Adding the Second Third hidden layer and the LSTM layer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-17"><span class="crayon-v">regressor</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-v">units</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-18">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-20"><span class="crayon-p"># Adding the output layer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-21"><span class="crayon-v">regressor</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">units</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-22">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-23"><span class="crayon-p"># Compiling the RNN</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-24"><span class="crayon-v">regressor</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'mean_squared_error'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-26"><span class="crayon-p">##################################################</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-28"><span class="crayon-e">import </span><span class="crayon-i">time</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-29"><span class="crayon-p"># Measuring the time taken by the model to train</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-30"><span class="crayon-v">StartTime</span><span class="crayon-o">=</span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-e">time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-31">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-32"><span class="crayon-p"># Fitting the RNN to the Training set</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-33"><span class="crayon-v">regressor</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-34">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-35"><span class="crayon-v">EndTime</span><span class="crayon-o">=</span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-e">time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd6f258974663-36"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"## Total Time Taken: "</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">round</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">EndTime</span><span class="crayon-o">-</span><span class="crayon-v">StartTime</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-cn">60</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Minutes ##'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0017 seconds] -->
<p></p>
<p></p>
<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="681" height="373" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-27.png" alt="Training LSTM model on stock prices data" class="wp-image-3283" srcset="https://thinkingneuron.com/wp-content/uploads/2020/10/image-27.png 681w, https://thinkingneuron.com/wp-content/uploads/2020/10/image-27-300x164.png 300w" sizes="(max-width: 681px) 100vw, 681px"></figure>
<p></p>
<p></p>
<hr class="wp-block-separator is-style-wide">
<p></p>
<p></p>
<h3 class="wp-block-heading"><strong>Measuring the accuracy of the model on testing data</strong></h3>
<p></p>
<p></p>
<p>Now using the trained model, we are checking if the predicted prices for the last 5 days are close to the actual prices or not.</p>
<p></p>
<p></p>
<p>Notice the inverse transform of the predictions. Since we normalized the data before the model training, the predictions on testing data will also be normalized, hence the inverse transformation will bring the values to the original scale. Then only we must calculate the percentage accuracy.</p>
<p></p>
<p></p><!-- Urvanov Syntax Highlighter v2.8.28 -->

		<div id="urvanov-syntax-highlighter-6640e6321dd71536703692" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -17.994px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Making predictions on test data
predicted_Price = regressor.predict(X_test)
predicted_Price = DataScaler.inverse_transform(predicted_Price)

# Getting the original price values for testing data
orig=y_test
orig=DataScaler.inverse_transform(y_test)

# Accuracy of the predictions
print('Accuracy:', 100 - (100*(abs(orig-predicted_Price)/orig)).mean())

# Visualising the results
import matplotlib.pyplot as plt

plt.plot(predicted_Price, color = 'blue', label = 'Predicted Volume')
plt.plot(orig, color = 'lightblue', label = 'Original Volume')

plt.title('Stock Price Predictions')
plt.xlabel('Trading Date')
plt.xticks(range(TestingRecords), StockData.tail(TestingRecords)['TradeDate'])
plt.ylabel('Stock Price')

plt.legend()
fig=plt.gcf()
fig.set_figwidth(20)
fig.set_figheight(6)
plt.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd71536703692-27">27</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-1"><span class="crayon-p"># Making predictions on test data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-2"><span class="crayon-v">predicted_Price</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">regressor</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-3"><span class="crayon-v">predicted_Price</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">DataScaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">predicted_Price</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-5"><span class="crayon-p"># Getting the original price values for testing data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-6"><span class="crayon-v">orig</span><span class="crayon-o">=</span><span class="crayon-e">y_test</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-7"><span class="crayon-v">orig</span><span class="crayon-o">=</span><span class="crayon-v">DataScaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-9"><span class="crayon-p"># Accuracy of the predictions</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-10"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy:'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">orig</span><span class="crayon-o">-</span><span class="crayon-v">predicted_Price</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-v">orig</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-12"><span class="crayon-p"># Visualising the results</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-13"><span class="crayon-e">import </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-15"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">predicted_Price</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'blue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Predicted Volume'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-16"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">orig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'lightblue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Original Volume'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-18"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Stock Price Predictions'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-19"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Trading Date'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-20"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xticks</span><span class="crayon-sy">(</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">TestingRecords</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">StockData</span><span class="crayon-sy">.</span><span class="crayon-e">tail</span><span class="crayon-sy">(</span><span class="crayon-v">TestingRecords</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-s">'TradeDate'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-21"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Stock Price'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-22">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-23"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-24"><span class="crayon-v">fig</span><span class="crayon-o">=</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">gcf</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-25"><span class="crayon-v">fig</span><span class="crayon-sy">.</span><span class="crayon-e">set_figwidth</span><span class="crayon-sy">(</span><span class="crayon-cn">20</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-26"><span class="crayon-v">fig</span><span class="crayon-sy">.</span><span class="crayon-e">set_figheight</span><span class="crayon-sy">(</span><span class="crayon-cn">6</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd71536703692-27"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p></p>
<p></p>
<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="982" height="352" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-28.png" alt="Measuring the accuracy of LSTM model on testing data" class="wp-image-3284" srcset="https://thinkingneuron.com/wp-content/uploads/2020/10/image-28.png 982w, https://thinkingneuron.com/wp-content/uploads/2020/10/image-28-300x108.png 300w, https://thinkingneuron.com/wp-content/uploads/2020/10/image-28-768x275.png 768w" sizes="(max-width: 982px) 100vw, 982px"></figure>
<p></p>
<p></p>
<hr class="wp-block-separator is-style-wide">
<p></p>
<p></p>
<h3 class="wp-block-heading"><strong>Visualizing the predictions for full data</strong></h3>
<p></p>
<p></p>
<p>Plotting the training and testing data both to see how good the LSTM model has fitted.</p>
<p></p>
<p></p><!-- Urvanov Syntax Highlighter v2.8.28 -->

		<div id="urvanov-syntax-highlighter-6640e6321dd72031135214" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -17.994px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Generating predictions on full data
TrainPredictions=DataScaler.inverse_transform(regressor.predict(X_train))
TestPredictions=DataScaler.inverse_transform(regressor.predict(X_test))

FullDataPredictions=np.append(TrainPredictions, TestPredictions)
FullDataOrig=FullData[TimeSteps:]

# plotting the full data
plt.plot(FullDataPredictions, color = 'blue', label = 'Predicted Price')
plt.plot(FullDataOrig , color = 'lightblue', label = 'Original Price')


plt.title('Stock Price Predictions')
plt.xlabel('Trading Date')
plt.ylabel('Stock Price')
plt.legend()
fig=plt.gcf()
fig.set_figwidth(20)
fig.set_figheight(8)
plt.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd72031135214-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd72031135214-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd72031135214-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd72031135214-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd72031135214-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd72031135214-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd72031135214-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd72031135214-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd72031135214-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd72031135214-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd72031135214-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd72031135214-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd72031135214-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd72031135214-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd72031135214-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd72031135214-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd72031135214-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd72031135214-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd72031135214-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd72031135214-20">20</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd72031135214-1"><span class="crayon-p"># Generating predictions on full data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd72031135214-2"><span class="crayon-v">TrainPredictions</span><span class="crayon-o">=</span><span class="crayon-v">DataScaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">regressor</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd72031135214-3"><span class="crayon-v">TestPredictions</span><span class="crayon-o">=</span><span class="crayon-v">DataScaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">regressor</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd72031135214-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd72031135214-5"><span class="crayon-v">FullDataPredictions</span><span class="crayon-o">=</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">TrainPredictions</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">TestPredictions</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd72031135214-6"><span class="crayon-v">FullDataOrig</span><span class="crayon-o">=</span><span class="crayon-v">FullData</span><span class="crayon-sy">[</span><span class="crayon-v">TimeSteps</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd72031135214-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd72031135214-8"><span class="crayon-p"># plotting the full data</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd72031135214-9"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">FullDataPredictions</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'blue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Predicted Price'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd72031135214-10"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-i">FullDataOrig</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'lightblue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Original Price'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd72031135214-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd72031135214-12">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd72031135214-13"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Stock Price Predictions'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd72031135214-14"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Trading Date'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd72031135214-15"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Stock Price'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd72031135214-16"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd72031135214-17"><span class="crayon-v">fig</span><span class="crayon-o">=</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">gcf</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd72031135214-18"><span class="crayon-v">fig</span><span class="crayon-sy">.</span><span class="crayon-e">set_figwidth</span><span class="crayon-sy">(</span><span class="crayon-cn">20</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd72031135214-19"><span class="crayon-v">fig</span><span class="crayon-sy">.</span><span class="crayon-e">set_figheight</span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd72031135214-20"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p></p>
<p></p>
<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="977" height="405" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-29.png" alt="LSTM model prediction plot on full data" class="wp-image-3285" srcset="https://thinkingneuron.com/wp-content/uploads/2020/10/image-29.png 977w, https://thinkingneuron.com/wp-content/uploads/2020/10/image-29-300x124.png 300w, https://thinkingneuron.com/wp-content/uploads/2020/10/image-29-768x318.png 768w" sizes="(max-width: 977px) 100vw, 977px"></figure>
<p></p>
<p></p>
<hr class="wp-block-separator is-style-wide">
<p></p>
<p></p>
<h3 class="wp-block-heading"><strong>How to predict the stock price for tomorrow</strong></h3>
<p></p>
<p></p>
<p>If you want to predict the price for tomorrow, all you have to do is to pass the last 10 day’s prices to the model in 3D format as it was used in the training.</p>
<p></p>
<p></p>
<p> The below snippet shows you how to take the last 10 prices manually and do a single prediction for the next price.</p>
<p></p>
<p></p><!-- Urvanov Syntax Highlighter v2.8.28 -->

		<div id="urvanov-syntax-highlighter-6640e6321dd74582095989" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -17.994px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Last 10 days prices
Last10Days=np.array([1002.15, 1009.9, 1007.5, 1019.75, 975.4,
            1011.45, 1010.4, 1009,1008.25, 1017.65])

# Normalizing the data just like we did for training the model
Last10Days=DataScaler.transform(Last10Days.reshape(-1,1))

# Changing the shape of the data to 3D
# Choosing TimeSteps as 10 because we have used the same for training
NumSamples=1
TimeSteps=10
NumFeatures=1
Last10Days=Last10Days.reshape(NumSamples,TimeSteps,NumFeatures)

#############################

# Making predictions on data
predicted_Price = regressor.predict(Last10Days)
predicted_Price = DataScaler.inverse_transform(predicted_Price)
predicted_Price</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd74582095989-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd74582095989-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd74582095989-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd74582095989-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd74582095989-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd74582095989-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd74582095989-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd74582095989-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd74582095989-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd74582095989-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd74582095989-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd74582095989-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd74582095989-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd74582095989-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd74582095989-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd74582095989-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd74582095989-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd74582095989-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd74582095989-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd74582095989-20">20</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd74582095989-1"><span class="crayon-p"># Last 10 days prices</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd74582095989-2"><span class="crayon-v">Last10Days</span><span class="crayon-o">=</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">1002.15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1009.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1007.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1019.75</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">975.4</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd74582095989-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">1011.45</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1010.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1009</span><span class="crayon-sy">,</span><span class="crayon-cn">1008.25</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1017.65</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd74582095989-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd74582095989-5"><span class="crayon-p"># Normalizing the data just like we did for training the model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd74582095989-6"><span class="crayon-v">Last10Days</span><span class="crayon-o">=</span><span class="crayon-v">DataScaler</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">Last10Days</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd74582095989-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd74582095989-8"><span class="crayon-p"># Changing the shape of the data to 3D</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd74582095989-9"><span class="crayon-p"># Choosing TimeSteps as 10 because we have used the same for training</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd74582095989-10"><span class="crayon-v">NumSamples</span><span class="crayon-o">=</span><span class="crayon-cn">1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd74582095989-11"><span class="crayon-v">TimeSteps</span><span class="crayon-o">=</span><span class="crayon-cn">10</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd74582095989-12"><span class="crayon-v">NumFeatures</span><span class="crayon-o">=</span><span class="crayon-cn">1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd74582095989-13"><span class="crayon-v">Last10Days</span><span class="crayon-o">=</span><span class="crayon-v">Last10Days</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">NumSamples</span><span class="crayon-sy">,</span><span class="crayon-v">TimeSteps</span><span class="crayon-sy">,</span><span class="crayon-v">NumFeatures</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd74582095989-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd74582095989-15"><span class="crayon-p">#############################</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd74582095989-16">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd74582095989-17"><span class="crayon-p"># Making predictions on data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd74582095989-18"><span class="crayon-v">predicted_Price</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">regressor</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">Last10Days</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd74582095989-19"><span class="crayon-v">predicted_Price</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">DataScaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">predicted_Price</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd74582095989-20"><span class="crayon-v">predicted_Price</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p></p>
<p></p>
<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="347" height="41" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-30.png" alt="Making a single prediction with LSTM" class="wp-image-3287" srcset="https://thinkingneuron.com/wp-content/uploads/2020/10/image-30.png 347w, https://thinkingneuron.com/wp-content/uploads/2020/10/image-30-300x35.png 300w" sizes="(max-width: 347px) 100vw, 347px"></figure>
<p></p>
<p></p>
<p>I have used the actual prices from the stock market till last friday in the above snippet!</p>
<p></p>
<p></p>
<p>So we see the model predicts the next closing price of <strong>Infosys</strong> fo today(5th-Oct-2020) is <strong>Rs</strong> <strong>1023</strong>! I checked and found the closing price for the day was <strong>Rs 1048</strong>! not bad for such little effort! 🙂</p>
<p></p>
<p></p>
<hr class="wp-block-separator is-style-wide">
<p></p>
<p></p>
<h3 class="wp-block-heading"><strong>What If I want to predict prices for the next 5 days?</strong></h3>
<p></p>
<p></p>
<p>The model which we have built above uses the last 10 days prices and predicts the next day’s price because we have trained our model with many past examples of the same granularity as shown below</p>
<p></p>
<p></p>
<p><strong><em>last 10 days prices–&gt; 11th day price</em></strong></p>
<p></p>
<p></p>
<p>Now if we want to predict the next 5 days or next 20 days prices, then we need to train the model with similar examples from the past like shown below</p>
<p></p>
<p></p>
<p><strong><em>last 10 days prices–&gt; Next 5 days price</em>s</strong></p>
<p></p>
<p></p>
<p>This is also known as <strong>Multi-Step</strong> time series prediction, where we predict multiple time steps ahead.</p>
<p></p>
<p></p>
<p>To achieve this, it will require small modifications in the data preparation step and in the LSTM model both.</p>
<p></p>
<p></p>
<p>However, keep in mind, the further you predict, the lesser accurate you might be, because stock prices are volatile and no one can know what is going to happen after 10 days! What kind of news will come? which might affect the prices of this stock!</p>
<p></p>
<p></p>
<p>Hence, it is recommended to predict for as less time steps as possible, for example next 2 days or next 5 days at max.</p>
<p></p>
<p></p>
<hr class="wp-block-separator is-style-wide">
<p></p>
<p></p>
<h3 class="wp-block-heading"><strong>Data Preparation for Multi Step LSTM</strong></h3>
<p></p>
<p></p>
<p>I am showing how to prepare the data for predicting next 5 days. The same code can be easily modified to predict next 10 days or 20 days as well.</p>
<p></p>
<p></p><!-- Urvanov Syntax Highlighter v2.8.28 -->

		<div id="urvanov-syntax-highlighter-6640e6321dd78753934428" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -17.994px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Considering the Full Data again which we extracted above
# Printing the last 10 values
print('Original Prices')
print(FullData[-10:])

print('###################')

# Printing last 10 values of the scaled data which we have created above for the last model
# Here I am changing the shape of the data to one dimensional array because
# for Multi step data preparation we need to X input in this fashion
X=X.reshape(X.shape[0],)
print('Scaled Prices')
print(X[-10:])</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd78753934428-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd78753934428-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd78753934428-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd78753934428-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd78753934428-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd78753934428-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd78753934428-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd78753934428-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd78753934428-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd78753934428-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd78753934428-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd78753934428-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd78753934428-13">13</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd78753934428-1"><span class="crayon-p"># Considering the Full Data again which we extracted above</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd78753934428-2"><span class="crayon-p"># Printing the last 10 values</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd78753934428-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Original Prices'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd78753934428-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">FullData</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">10</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd78753934428-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd78753934428-6"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'###################'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd78753934428-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd78753934428-8"><span class="crayon-p"># Printing last 10 values of the scaled data which we have created above for the last model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd78753934428-9"><span class="crayon-p"># Here I am changing the shape of the data to one dimensional array because</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd78753934428-10"><span class="crayon-p"># for Multi step data preparation we need to X input in this fashion</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd78753934428-11"><span class="crayon-v">X</span><span class="crayon-o">=</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd78753934428-12"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Scaled Prices'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd78753934428-13"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">10</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p></p>
<div class="wp-block-image">
<figure class="aligncenter size-large"><img decoding="async" loading="lazy" width="648" height="335" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image.png" alt="Sample data for LSTM multi step stock prices prediction" class="wp-image-3332" srcset="https://thinkingneuron.com/wp-content/uploads/2021/03/image.png 648w, https://thinkingneuron.com/wp-content/uploads/2021/03/image-300x155.png 300w" sizes="(max-width: 648px) 100vw, 648px"><figcaption>Sample data for LSTM multi step stock prices prediction</figcaption></figure>
</div>
<p></p>
<p></p>
<p>I have modified the data split logic from the last model to produce the <strong>input–&gt;output</strong> pairs by defining <strong>FutureTimeSteps=5</strong>. This determines we want to predict the next 5 days’ prices based on the last 10 days.</p>
<p></p>
<p></p><!-- Urvanov Syntax Highlighter v2.8.28 -->

		<div id="urvanov-syntax-highlighter-6640e6321dd7a627560240" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -17.994px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Multi step data preparation

# split into samples
X_samples = list()
y_samples = list()

NumerOfRows = len(X)
TimeSteps=10  # next few day's Price Prediction is based on last how many past day's prices
FutureTimeSteps=5 # How many days in future you want to predict the prices

# Iterate thru the values to create combinations
for i in range(TimeSteps , NumerOfRows-FutureTimeSteps , 1):
    x_sample = X[i-TimeSteps:i]
    y_sample = X[i:i+FutureTimeSteps]
    X_samples.append(x_sample)
    y_samples.append(y_sample)

################################################

# Reshape the Input as a 3D (samples, Time Steps, Features)
X_data=np.array(X_samples)
X_data=X_data.reshape(X_data.shape[0],X_data.shape[1], 1)
print('### Input Data Shape ###') 
print(X_data.shape)

# We do not reshape y as a 3D data  as it is supposed to be a single column only
y_data=np.array(y_samples)
print('### Output Data Shape ###') 
print(y_data.shape)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7a627560240-29">29</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-1"><span class="crayon-p"># Multi step data preparation</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-3"><span class="crayon-p"># split into samples</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-4"><span class="crayon-v">X_samples</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-5"><span class="crayon-v">y_samples</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-7"><span class="crayon-v">NumerOfRows</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-8"><span class="crayon-v">TimeSteps</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-p"># next few day's Price Prediction is based on last how many past day's prices</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-9"><span class="crayon-v">FutureTimeSteps</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-h"> </span><span class="crayon-p"># How many days in future you want to predict the prices</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-11"><span class="crayon-p"># Iterate thru the values to create combinations</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-12"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-i">TimeSteps</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">NumerOfRows</span><span class="crayon-o">-</span><span class="crayon-i">FutureTimeSteps</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x_sample</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">-</span><span class="crayon-v">TimeSteps</span><span class="crayon-o">:</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">y_sample</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-o">:</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-v">FutureTimeSteps</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">X_samples</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">x_sample</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">y_samples</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">y_sample</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-18"><span class="crayon-p">################################################</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-20"><span class="crayon-p"># Reshape the Input as a 3D (samples, Time Steps, Features)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-21"><span class="crayon-v">X_data</span><span class="crayon-o">=</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">X_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-22"><span class="crayon-v">X_data</span><span class="crayon-o">=</span><span class="crayon-v">X_data</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">X_data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-v">X_data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-23"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'### Input Data Shape ###'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-24"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">X_data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-26"><span class="crayon-p"># We do not reshape y as a 3D data&nbsp;&nbsp;as it is supposed to be a single column only</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-27"><span class="crayon-v">y_data</span><span class="crayon-o">=</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-v">y_samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-28"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'### Output Data Shape ###'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7a627560240-29"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">y_data</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<p></p>
<div class="wp-block-image">
<figure class="alignleft size-large"><img decoding="async" loading="lazy" width="248" height="89" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-1.png" alt="Input/output shape for LSTM multi step model" class="wp-image-3333"></figure>
</div>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<hr class="wp-block-separator is-style-wide">
<p></p>
<p></p>
<h3 class="wp-block-heading"><strong>Splitting the data into Training and Testing</strong></h3>
<p></p>
<p></p><!-- Urvanov Syntax Highlighter v2.8.28 -->

		<div id="urvanov-syntax-highlighter-6640e6321dd7c724299315" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -17.994px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Choosing the number of testing data records
TestingRecords=5

# Splitting the data into train and test
X_train=X_data[:-TestingRecords]
X_test=X_data[-TestingRecords:]
y_train=y_data[:-TestingRecords]
y_test=y_data[-TestingRecords:]

#############################################
# Printing the shape of training and testing
print('\n#### Training Data shape ####')
print(X_train.shape)
print(y_train.shape)

print('\n#### Testing Data shape ####')
print(X_test.shape)
print(y_test.shape)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7c724299315-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7c724299315-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7c724299315-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7c724299315-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7c724299315-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7c724299315-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7c724299315-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7c724299315-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7c724299315-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7c724299315-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7c724299315-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7c724299315-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7c724299315-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7c724299315-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7c724299315-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7c724299315-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7c724299315-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7c724299315-18">18</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7c724299315-1"><span class="crayon-p"># Choosing the number of testing data records</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7c724299315-2"><span class="crayon-v">TestingRecords</span><span class="crayon-o">=</span><span class="crayon-cn">5</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7c724299315-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7c724299315-4"><span class="crayon-p"># Splitting the data into train and test</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7c724299315-5"><span class="crayon-v">X_train</span><span class="crayon-o">=</span><span class="crayon-v">X_data</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-v">TestingRecords</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7c724299315-6"><span class="crayon-v">X_test</span><span class="crayon-o">=</span><span class="crayon-v">X_data</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">TestingRecords</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7c724299315-7"><span class="crayon-v">y_train</span><span class="crayon-o">=</span><span class="crayon-v">y_data</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-v">TestingRecords</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7c724299315-8"><span class="crayon-v">y_test</span><span class="crayon-o">=</span><span class="crayon-v">y_data</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">TestingRecords</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7c724299315-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7c724299315-10"><span class="crayon-p">#############################################</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7c724299315-11"><span class="crayon-p"># Printing the shape of training and testing</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7c724299315-12"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'\n#### Training Data shape ####'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7c724299315-13"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7c724299315-14"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">y_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7c724299315-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7c724299315-16"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'\n#### Testing Data shape ####'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7c724299315-17"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7c724299315-18"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<p></p>
<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="289" height="152" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-2.png" alt="Training and Testing Data shape for Multi step LSTM model" class="wp-image-3334"></figure>
<p></p>
<p></p>
<hr class="wp-block-separator is-style-wide">
<p></p>
<p></p>
<h3 class="wp-block-heading"><strong>Visualizing the input-&gt;output sent to LSTM Multi-step model</strong></h3>
<p></p>
<p></p>
<p>Printing some records of input and output always helps to understand the process in a LSTM model. </p>
<p></p>
<p></p>
<p>You can see here the input is a 3D array of the last 10 days’ prices and the output is an array of the next 5 days’ prices.</p>
<p></p>
<p></p><!-- Urvanov Syntax Highlighter v2.8.28 -->

		<div id="urvanov-syntax-highlighter-6640e6321dd7e972832872" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -17.994px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Visualizing the input and output being sent to the LSTM model
# Based on last 10 days prices we are learning the next 5 days of prices
for inp, out in zip(X_train[0:2], y_train[0:2]):
    print(inp)
    print('====&gt;')
    print(out)
    print('#'*20)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7e972832872-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7e972832872-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7e972832872-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7e972832872-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7e972832872-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7e972832872-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7e972832872-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7e972832872-1"><span class="crayon-p"># Visualizing the input and output being sent to the LSTM model</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7e972832872-2"><span class="crayon-p"># Based on last 10 days prices we are learning the next 5 days of prices</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7e972832872-3"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">inp</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">out </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7e972832872-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">inp</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7e972832872-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'====&gt;'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7e972832872-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">out</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7e972832872-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'#'</span><span class="crayon-o">*</span><span class="crayon-cn">20</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<p></p>
<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="543" height="573" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-3.png" alt="Input vs output model for Multi step LSTM model" class="wp-image-3335" srcset="https://thinkingneuron.com/wp-content/uploads/2021/03/image-3.png 543w, https://thinkingneuron.com/wp-content/uploads/2021/03/image-3-284x300.png 284w" sizes="(max-width: 543px) 100vw, 543px"></figure>
<p></p>
<p></p>
<hr class="wp-block-separator is-style-wide">
<p></p>
<p></p>
<h3 class="wp-block-heading"><strong>Creating the Deep Learning Multi-Step LSTM model</strong></h3>
<p></p>
<p></p>
<p>I am using the same configurations as used in the last model. The change is done at the <strong>Dense</strong> layer. Now the dense layer outputs the number of values equal to the FutureTimeSteps. Which is 5 in this case since we want to predict the next 5 days. </p>
<p></p>
<p></p>
<p>You can change this to 10 to 20 if you want to predict for more days, but you need to prepare the data in the same manner before running this code.</p>
<p></p>
<p></p><!-- Urvanov Syntax Highlighter v2.8.28 -->

		<div id="urvanov-syntax-highlighter-6640e6321dd7f926676665" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -17.994px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Defining Input shapes for LSTM
TimeSteps=X_train.shape[1]
TotalFeatures=X_train.shape[2]
print("Number of TimeSteps:", TimeSteps)
print("Number of Features:", TotalFeatures)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7f926676665-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7f926676665-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7f926676665-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd7f926676665-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd7f926676665-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7f926676665-1"><span class="crayon-p"># Defining Input shapes for LSTM</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7f926676665-2"><span class="crayon-v">TimeSteps</span><span class="crayon-o">=</span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7f926676665-3"><span class="crayon-v">TotalFeatures</span><span class="crayon-o">=</span><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd7f926676665-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Number of TimeSteps:"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">TimeSteps</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd7f926676665-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Number of Features:"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">TotalFeatures</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p></p>
<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="227" height="43" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-4.png" alt="Defining the time steps and features for the LSTM model" class="wp-image-3336"></figure>
<p></p>
<p></p><!-- Urvanov Syntax Highlighter v2.8.28 -->

		<div id="urvanov-syntax-highlighter-6640e6321dd81722950698" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -17.994px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Importing the Keras libraries and packages
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM

# Initialising the RNN
regressor = Sequential()

# Adding the First input hidden layer and the LSTM layer
# return_sequences = True, means the output of every time step to be shared with hidden next layer
regressor.add(LSTM(units = 10, activation = 'relu', input_shape = (TimeSteps, TotalFeatures), return_sequences=True))


# Adding the Second hidden layer and the LSTM layer
regressor.add(LSTM(units = 5, activation = 'relu', input_shape = (TimeSteps, TotalFeatures), return_sequences=True))

# Adding the Third hidden layer and the LSTM layer
regressor.add(LSTM(units = 5, activation = 'relu', return_sequences=False ))


# Adding the output layer
# Notice the number of neurons in the dense layer is now the number of future time steps 
# Based on the number of future days we want to predict
regressor.add(Dense(units = FutureTimeSteps))

# Compiling the RNN
regressor.compile(optimizer = 'adam', loss = 'mean_squared_error')

###################################################################

import time
# Measuring the time taken by the model to train
StartTime=time.time()

# Fitting the RNN to the Training set
regressor.fit(X_train, y_train, batch_size = 5, epochs = 100)

EndTime=time.time()
print("############### Total Time Taken: ", round((EndTime-StartTime)/60), 'Minutes #############')</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd81722950698-39">39</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-1"><span class="crayon-p"># Importing the Keras libraries and packages</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-3"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-i">LSTM</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-6"><span class="crayon-p"># Initialising the RNN</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-7"><span class="crayon-v">regressor</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-9"><span class="crayon-p"># Adding the First input hidden layer and the LSTM layer</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-10"><span class="crayon-p"># return_sequences = True, means the output of every time step to be shared with hidden next layer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-11"><span class="crayon-v">regressor</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-v">units</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">TimeSteps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">TotalFeatures</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-12">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-14"><span class="crayon-p"># Adding the Second hidden layer and the LSTM layer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-15"><span class="crayon-v">regressor</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-v">units</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_shape</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">TimeSteps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">TotalFeatures</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-16">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-17"><span class="crayon-p"># Adding the Third hidden layer and the LSTM layer</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-18"><span class="crayon-v">regressor</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">LSTM</span><span class="crayon-sy">(</span><span class="crayon-v">units</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">return_sequences</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-h"> </span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-20">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-21"><span class="crayon-p"># Adding the output layer</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-22"><span class="crayon-p"># Notice the number of neurons in the dense layer is now the number of future time steps </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-23"><span class="crayon-p"># Based on the number of future days we want to predict</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-24"><span class="crayon-v">regressor</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">units</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">FutureTimeSteps</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-26"><span class="crayon-p"># Compiling the RNN</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-27"><span class="crayon-v">regressor</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'mean_squared_error'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-28">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-29"><span class="crayon-p">###################################################################</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-30">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-31"><span class="crayon-e">import </span><span class="crayon-i">time</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-32"><span class="crayon-p"># Measuring the time taken by the model to train</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-33"><span class="crayon-v">StartTime</span><span class="crayon-o">=</span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-e">time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-34">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-35"><span class="crayon-p"># Fitting the RNN to the Training set</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-36"><span class="crayon-v">regressor</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-38"><span class="crayon-v">EndTime</span><span class="crayon-o">=</span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-e">time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd81722950698-39"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"############### Total Time Taken: "</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">round</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">EndTime</span><span class="crayon-o">-</span><span class="crayon-v">StartTime</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-cn">60</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Minutes #############'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p></p>
<p></p>
<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="672" height="366" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-5.png" alt="Training the multi step LSTM model" class="wp-image-3337" srcset="https://thinkingneuron.com/wp-content/uploads/2021/03/image-5.png 672w, https://thinkingneuron.com/wp-content/uploads/2021/03/image-5-300x163.png 300w" sizes="(max-width: 672px) 100vw, 672px"></figure>
<p></p>
<p></p>
<hr class="wp-block-separator is-style-wide">
<p></p>
<p></p>
<h3 class="wp-block-heading"><strong>Measuring the Accuracy of the model on testing data</strong></h3>
<p></p>
<p></p>
<p>Since this is Multi step model trained to predict next 5 days. Each prediction will generate 5 days’ prices which we can match with the original prices. </p>
<p></p>
<p></p>
<p></p>
<p></p>
<p>We will compare them one row at a time.</p>
<p></p>
<p></p><!-- Urvanov Syntax Highlighter v2.8.28 -->

		<div id="urvanov-syntax-highlighter-6640e6321dd83523392699" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -17.994px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Making predictions on test data
predicted_Price = regressor.predict(X_test)
predicted_Price = DataScaler.inverse_transform(predicted_Price)
print('#### Predicted Prices ####')
print(predicted_Price)

# Getting the original price values for testing data
orig=y_test
orig=DataScaler.inverse_transform(y_test)
print('\n#### Original Prices ####')
print(orig)</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd83523392699-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd83523392699-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd83523392699-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd83523392699-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd83523392699-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd83523392699-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd83523392699-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd83523392699-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd83523392699-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd83523392699-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd83523392699-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd83523392699-1"><span class="crayon-p"># Making predictions on test data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd83523392699-2"><span class="crayon-v">predicted_Price</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">regressor</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd83523392699-3"><span class="crayon-v">predicted_Price</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">DataScaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">predicted_Price</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd83523392699-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'#### Predicted Prices ####'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd83523392699-5"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">predicted_Price</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd83523392699-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd83523392699-7"><span class="crayon-p"># Getting the original price values for testing data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd83523392699-8"><span class="crayon-v">orig</span><span class="crayon-o">=</span><span class="crayon-e">y_test</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd83523392699-9"><span class="crayon-v">orig</span><span class="crayon-o">=</span><span class="crayon-v">DataScaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd83523392699-10"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'\n#### Original Prices ####'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd83523392699-11"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">orig</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<p></p>
<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="513" height="287" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-6.png" alt="Original and Predicted prices in LSTM Multi Step model" class="wp-image-3340" srcset="https://thinkingneuron.com/wp-content/uploads/2021/03/image-6.png 513w, https://thinkingneuron.com/wp-content/uploads/2021/03/image-6-300x168.png 300w" sizes="(max-width: 513px) 100vw, 513px"></figure>
<p></p>
<p></p>
<p>Each row represents the original prices and the predicted prices.</p>
<p></p>
<p></p>
<p>We will compare one row at a time. Using a simple for-loop, each row of original values are compared with the predicted values</p>
<p></p>
<p></p><!-- Urvanov Syntax Highlighter v2.8.28 -->

		<div id="urvanov-syntax-highlighter-6640e6321dd84158116042" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -17.994px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">import matplotlib.pyplot as plt

for i in range(len(orig)):
    Prediction=predicted_Price[i]
    Original=orig[i]
    
    # Visualising the results
    plt.plot(Prediction, color = 'blue', label = 'Predicted Volume')
    plt.plot(Original, color = 'lightblue', label = 'Original Volume')

    plt.title('### Accuracy of the predictions:'+ str(100 - (100*(abs(Original-Prediction)/Original)).mean().round(2))+'% ###')
    plt.xlabel('Trading Date')
    
    startDateIndex=(FutureTimeSteps*TestingRecords)-FutureTimeSteps*(i+1)
    endDateIndex=(FutureTimeSteps*TestingRecords)-FutureTimeSteps*(i+1) + FutureTimeSteps
    TotalRows=StockData.shape[0]

    plt.xticks(range(FutureTimeSteps), StockData.iloc[TotalRows-endDateIndex : TotalRows-(startDateIndex) , :]['TradeDate'])
    plt.ylabel('Stock Price')

    plt.legend()
    fig=plt.gcf()
    fig.set_figwidth(20)
    fig.set_figheight(3)
    plt.show()</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd84158116042-25">25</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-1"><span class="crayon-e">import </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">plt</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-3"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">orig</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Prediction</span><span class="crayon-o">=</span><span class="crayon-v">predicted_Price</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Original</span><span class="crayon-o">=</span><span class="crayon-v">orig</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># Visualising the results</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">Prediction</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'blue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Predicted Volume'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">Original</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'lightblue'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Original Volume'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'### Accuracy of the predictions:'</span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">100</span><span class="crayon-o">*</span><span class="crayon-sy">(</span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">Original</span><span class="crayon-o">-</span><span class="crayon-v">Prediction</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-v">Original</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">+</span><span class="crayon-s">'% ###'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Trading Date'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">startDateIndex</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-e ">FutureTimeSteps*</span><span class="crayon-v">TestingRecords</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-e ">FutureTimeSteps*</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">endDateIndex</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-e ">FutureTimeSteps*</span><span class="crayon-v">TestingRecords</span><span class="crayon-sy">)</span><span class="crayon-o">-</span><span class="crayon-e ">FutureTimeSteps*</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-o">+</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">FutureTimeSteps</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-16"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">TotalRows</span><span class="crayon-o">=</span><span class="crayon-v">StockData</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xticks</span><span class="crayon-sy">(</span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">FutureTimeSteps</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">StockData</span><span class="crayon-sy">.</span><span class="crayon-v">iloc</span><span class="crayon-sy">[</span><span class="crayon-v">TotalRows</span><span class="crayon-o">-</span><span class="crayon-v">endDateIndex</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">TotalRows</span><span class="crayon-o">-</span><span class="crayon-sy">(</span><span class="crayon-v">startDateIndex</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">'TradeDate'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Stock Price'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-20">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fig</span><span class="crayon-o">=</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">gcf</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fig</span><span class="crayon-sy">.</span><span class="crayon-e">set_figwidth</span><span class="crayon-sy">(</span><span class="crayon-cn">20</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fig</span><span class="crayon-sy">.</span><span class="crayon-e">set_figheight</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd84158116042-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p></p>
<p></p>
<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="896" height="569" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-8.png" alt="LSTM predictions part-1" class="wp-image-3342" srcset="https://thinkingneuron.com/wp-content/uploads/2021/03/image-8.png 896w, https://thinkingneuron.com/wp-content/uploads/2021/03/image-8-300x191.png 300w, https://thinkingneuron.com/wp-content/uploads/2021/03/image-8-768x488.png 768w" sizes="(max-width: 896px) 100vw, 896px"></figure>
<p></p>
<p></p>
<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="899" height="560" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-9.png" alt="LSTM predictions Part-2" class="wp-image-3343" srcset="https://thinkingneuron.com/wp-content/uploads/2021/03/image-9.png 899w, https://thinkingneuron.com/wp-content/uploads/2021/03/image-9-300x187.png 300w, https://thinkingneuron.com/wp-content/uploads/2021/03/image-9-768x478.png 768w" sizes="(max-width: 899px) 100vw, 899px"></figure>
<p></p>
<p></p>
<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="894" height="273" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-10.png" alt="LSTM  Multi step predictions part-3" class="wp-image-3344" srcset="https://thinkingneuron.com/wp-content/uploads/2021/03/image-10.png 894w, https://thinkingneuron.com/wp-content/uploads/2021/03/image-10-300x92.png 300w, https://thinkingneuron.com/wp-content/uploads/2021/03/image-10-768x235.png 768w" sizes="(max-width: 894px) 100vw, 894px"></figure>
<p></p>
<p></p>
<hr class="wp-block-separator is-style-wide">
<p></p>
<p></p>
<h3 class="wp-block-heading"><strong>Making predictions for the next 5 days</strong></h3>
<p></p>
<p></p>
<p>If you want to predict the price for the next 5 days, all you have to do is to pass the last 10 day’s prices to the model in 3D format as it was used in the training.</p>
<p></p>
<p></p>
<p>The below snippet shows you how to pass the last 10 values manually to get the next 5 days’ price predictions.</p>
<p></p>
<p></p><!-- Urvanov Syntax Highlighter v2.8.28 -->

		<div id="urvanov-syntax-highlighter-6640e6321dd86491330969" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -17.994px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button urvanov-syntax-highlighter-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-plain-button" title="Toggle Plain Code"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-wrap-button" title="Toggle Line Wrap"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-expand-button" title="Expand Code" style="display: none;"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-copy-button" title="Copy"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button urvanov-syntax-highlighter-popup-button" title="Open Code In New Window"><div class="urvanov-syntax-highlighter-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://thinkingneuron.com/wp-content/plugins/urvanov-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea wrap="soft" class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># Making predictions on test data
Last10DaysPrices=array([1376.2, 1371.75,1387.15,1370.5 ,1344.95, 
                   1312.05, 1316.65, 1339.45, 1339.7 ,1340.85])

# Reshaping the data to (-1,1 )because its a single entry
Last10DaysPrices=Last10DaysPrices.reshape(-1, 1)

# Scaling the data on the same level on which model was trained
X_test=DataScaler.transform(Last10DaysPrices)

NumberofSamples=1
TimeSteps=X_test.shape[0]
NumberofFeatures=X_test.shape[1]
# Reshaping the data as 3D input
X_test=X_test.reshape(NumberofSamples,TimeSteps,NumberofFeatures)

# Generating the predictions for next 5 days
Next5DaysPrice = regressor.predict(X_test)

# Generating the prices in original scale
Next5DaysPrice = DataScaler.inverse_transform(Next5DaysPrice)
Next5DaysPrice</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6640e6321dd86491330969-22">22</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-1"><span class="crayon-p"># Making predictions on test data</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-2"><span class="crayon-v">Last10DaysPrices</span><span class="crayon-o">=</span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">1376.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1371.75</span><span class="crayon-sy">,</span><span class="crayon-cn">1387.15</span><span class="crayon-sy">,</span><span class="crayon-cn">1370.5</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">1344.95</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-cn">1312.05</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1316.65</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1339.45</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1339.7</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-cn">1340.85</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-5"><span class="crayon-p"># Reshaping the data to (-1,1 )because its a single entry</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-6"><span class="crayon-v">Last10DaysPrices</span><span class="crayon-o">=</span><span class="crayon-v">Last10DaysPrices</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-8"><span class="crayon-p"># Scaling the data on the same level on which model was trained</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-9"><span class="crayon-v">X_test</span><span class="crayon-o">=</span><span class="crayon-v">DataScaler</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">Last10DaysPrices</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-11"><span class="crayon-v">NumberofSamples</span><span class="crayon-o">=</span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-12"><span class="crayon-v">TimeSteps</span><span class="crayon-o">=</span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-13"><span class="crayon-v">NumberofFeatures</span><span class="crayon-o">=</span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-14"><span class="crayon-p"># Reshaping the data as 3D input</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-15"><span class="crayon-v">X_test</span><span class="crayon-o">=</span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">NumberofSamples</span><span class="crayon-sy">,</span><span class="crayon-v">TimeSteps</span><span class="crayon-sy">,</span><span class="crayon-v">NumberofFeatures</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-16">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-17"><span class="crayon-p"># Generating the predictions for next 5 days</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-18"><span class="crayon-v">Next5DaysPrice</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">regressor</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-20"><span class="crayon-p"># Generating the prices in original scale</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-21"><span class="crayon-v">Next5DaysPrice</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">DataScaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">Next5DaysPrice</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6640e6321dd86491330969-22"><span class="crayon-v">Next5DaysPrice</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p></p>
<p></p>
<figure class="wp-block-image size-large"><img decoding="async" loading="lazy" width="619" height="49" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/image-11.png" alt="Next 5 days stock price prediction using LSTM multi step model." class="wp-image-3345" srcset="https://thinkingneuron.com/wp-content/uploads/2021/03/image-11.png 619w, https://thinkingneuron.com/wp-content/uploads/2021/03/image-11-300x24.png 300w" sizes="(max-width: 619px) 100vw, 619px"></figure>
<p></p>
<p></p>
<hr class="wp-block-separator is-style-wide">
<p></p>
<p></p>
<h3 class="wp-block-heading"><strong>Conclusion</strong></h3>
<p></p>
<p></p>
<p>This prediction is only short-term. The moment you try to predict for multiple days like the next 30-days or 60 days, this fails miserably. Not because our LSTM model is bad, but, because Stock markets are highly volatile. So, don’t bet your money simply on this model! Do some research and then use this model as a complementary tool for analysis!</p>
<p></p>
<p></p>
<p>I hope you enjoyed reading this post and it helped you clear some of your doubts regarding LSTM models. Consider sharing this post with your friends to help spread the knowledge 🙂</p>
<p><input type="hidden" value="3266"></p>
        				<div id="uab-frontend-wrapper" class="uab-frontend-wrapper 
			uab-template-4">
				<div id="uab-tab-index-wrapper" class="uab-tab-index-wrapper" style="display:none;">
					<ul class="uab-tabs uab-clearfix">
						<li class="tab-link uab_author_detail uab-current" data-tab="tab-1" data-name="Author Details">
							Author Details						</li>
											</ul>
				</div>

				
				<div id="tab-1" class="uab-tab-content uab-current">
											<div class="uab-defaut-tab-wrapper ">
							<div class="uab-defaut-tab 
							uab-clearfix">
								<div class="uab-social-icons">
		<ul id="uap-social-outlets-fields">
							<li class="uab-icon-twitter">
						<a href="https://twitter.com/ThinkingNeuron?t=HaJgx1gvMBXL4g2f7DVNBA&amp;s=08" target="_blank">
							<svg class="svg-inline--fa fa-twitter fa-w-16" aria-hidden="true" data-prefix="fab" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg><!-- <i class="fab fa-twitter"></i> -->
						</a>
					</li>
										<li class="uab-icon-youtube">
						<a href="https://www.youtube.com/channel/UCqb03ZB4sRDvcT7O7DTI_Sg" target="_blank">
							<svg class="svg-inline--fa fa-youtube fa-w-18" aria-hidden="true" data-prefix="fab" data-icon="youtube" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" data-fa-i2svg=""><path fill="currentColor" d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"></path></svg><!-- <i class="fab fa-youtube"></i> -->
						</a>
					</li>
										<li class="uab-icon-linkedin">
						<a href="https://www.linkedin.com/in/farukh-hashmi/" target="_blank">
							<svg class="svg-inline--fa fa-linkedin fa-w-14" aria-hidden="true" data-prefix="fab" data-icon="linkedin" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg><!-- <i class="fab fa-linkedin"></i> -->
						</a>
					</li>
						</ul>
</div>
<div class="uab-author-profile-pic">
		<div class="uap-profile-image uap-profile-image-circle">
						<!--Custom Image-->
				<img decoding="async" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/Farukh-Hashmi-Profile-pic.jpg" width="200">
					</div>
</div><div class="uab-front-content">
		<span class="uab-tab-header">
			Author Details		</span>
			<div class="uab-display-name">
		<!-- User Display Name -->
		<a href="https://thinkingneuron.com/author/admin/" target="_blank">Farukh Hashmi</a>
		
			</div>
			<div class="uab-company-info">
			<span class="uab-company-designation">
				Lead Data Scientist			</span> 		</div>
		<div class="uab-short-info">
	Farukh is an innovator in solving industry problems using Artificial intelligence. His expertise is backed with 10 years of industry experience. Being a senior data scientist he is responsible for designing the AI/ML solution to provide maximum gains for the clients. As a thought leader, his focus is on solving the key business problems of the CPG Industry. He has worked across different domains like Telecom, Insurance, and Logistics. He has worked with global tech leaders including Infosys, IBM, and Persistent systems. His passion to teach inspired him to create this website!</div><div class="uab-short-contact ">
				
		<div class="uab-contact-inner">

							<div class="uab-user-website">
					<a href="https://thinkingneuron.com/" target="_blank">https://thinkingneuron.com/</a>
				</div>
				
							
		</div>
		
		<div class="uab-contact-inner">
				<div class="uab-user-email">
			<a href="mailto:thinkingneuron@gmail.com">thinkingneuron@gmail.com</a>
		</div>
	</div>
	</div></div>


							</div>
						</div>
											</div>	
										
				</div>
				
	        	
		
		
			</div><!-- .entry-content .clear -->
</div>

	
</article><!-- #post-## -->


	<nav class="navigation post-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://thinkingneuron.com/how-to-use-artificial-neural-networks-for-classification-in-python/" rel="prev"><span class="ast-left-arrow">←</span> How to use Artificial Neural Networks for classification in python?</a></div><div class="nav-next"><a href="https://thinkingneuron.com/face-recognition-using-deep-learning-cnn-in-python/" rel="next">Face Recognition using Deep Learning CNN in Python <span class="ast-right-arrow">→</span></a></div></div>
	</nav>
<div id="comments" class="comments-area">

	
			<div class="comments-count-wrapper">
			<h3 class="comments-title">
				42 thoughts on “Predicting stock prices using Deep Learning LSTM model in Python”			</h3>
		</div>

		
		<ol class="ast-comment-list">
							<li class="comment even thread-even depth-1" id="li-comment-186">

					<article id="comment-186" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/4bff9538a2c144ec00f6a0cb0dc2545c.png" srcset="https://secure.gravatar.com/avatar/4bff9538a2c144ec00f6a0cb0dc2545c?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">patickyu</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-186"><time datetime="2021-03-18T08:04:49+00:00">March 18, 2021 at 8:04 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>thank you so much for your code<br>
I just have question. What if i want to predict next 5 days price.<br>
how can I change your code?</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-186" data-commentid="186" data-postid="3266" data-belowelement="comment-186" data-respondelement="respond" data-replyto="Reply to patickyu" aria-label="Reply to patickyu">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				<ol class="children">
				<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-190">

					<article id="comment-190" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/32461ffa804faacb2279c6b84ccf1f52.png" srcset="https://secure.gravatar.com/avatar/32461ffa804faacb2279c6b84ccf1f52?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Farukh Hashmi</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-190"><time datetime="2021-03-25T03:53:46+00:00">March 25, 2021 at 3:53 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>I have updated the post for multiple days price predictions!</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-190" data-commentid="190" data-postid="3266" data-belowelement="comment-190" data-respondelement="respond" data-replyto="Reply to Farukh Hashmi" aria-label="Reply to Farukh Hashmi">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				<ol class="children">
				<li class="comment even depth-3" id="li-comment-200">

					<article id="comment-200" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/34667c4bc3be463721d0aea312ae293a.png" srcset="https://secure.gravatar.com/avatar/34667c4bc3be463721d0aea312ae293a?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Rob</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-200"><time datetime="2021-04-19T21:04:16+00:00">April 19, 2021 at 9:04 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>When using the previous 10 days to predict 5 days in the future, does the program use a “sliding window” to make its predictions? In other words, the 11th day knows about the previous 10 days, but does the 12th day know about the prediction made for the 11th day?</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-200" data-commentid="200" data-postid="3266" data-belowelement="comment-200" data-respondelement="respond" data-replyto="Reply to Rob" aria-label="Reply to Rob">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
				<li class="comment odd alt depth-3" id="li-comment-453">

					<article id="comment-453" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/25da383cb7b833053b056ebbfe2ff153.png" srcset="https://secure.gravatar.com/avatar/25da383cb7b833053b056ebbfe2ff153?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">YOngHo Jang</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-453"><time datetime="2022-03-25T04:22:13+00:00">March 25, 2022 at 4:22 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Wonderful! Wonderful! Very good! Thank You! I would like to refer to the source code for LSTM and use it in a research paper on stock error correction using lstm. I want to get permission to use it. From Busan in Korea<br>
Thank you for your permission.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-453" data-commentid="453" data-postid="3266" data-belowelement="comment-453" data-respondelement="respond" data-replyto="Reply to YOngHo Jang" aria-label="Reply to YOngHo Jang">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				<ol class="children">
				<li class="comment even depth-4" id="li-comment-454">

					<article id="comment-454" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/25da383cb7b833053b056ebbfe2ff153.png" srcset="https://secure.gravatar.com/avatar/25da383cb7b833053b056ebbfe2ff153?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">YongHo Jang</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-454"><time datetime="2022-03-25T04:27:39+00:00">March 25, 2022 at 4:27 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>sorry! sorry! my mistake<br>
I would appreciate it if you would allow it.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-454" data-commentid="454" data-postid="3266" data-belowelement="comment-454" data-respondelement="respond" data-replyto="Reply to YongHo Jang" aria-label="Reply to YongHo Jang">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				<ol class="children">
				<li class="comment byuser comment-author-admin bypostauthor odd alt depth-5" id="li-comment-455">

					<article id="comment-455" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/32461ffa804faacb2279c6b84ccf1f52.png" srcset="https://secure.gravatar.com/avatar/32461ffa804faacb2279c6b84ccf1f52?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn"><a href="https://thinkingneuron.com/" class="url" rel="ugc">Farukh Hashmi</a></b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-455"><time datetime="2022-03-25T05:34:56+00:00">March 25, 2022 at 5:34 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hi YOngHo!<br>
Thank you for your kind words!<br>
Yes you can use this code for your research.<br>
All the best!<br>
Farukh Hashmi</p>
								<div class="ast-comment-edit-reply-wrap">
																										</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="comment even thread-odd thread-alt depth-1" id="li-comment-197">

					<article id="comment-197" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/ba6454ad543c7cfb773ad01efb902e2f.png" srcset="https://secure.gravatar.com/avatar/ba6454ad543c7cfb773ad01efb902e2f?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Nathaniel Kren</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-197"><time datetime="2021-04-15T21:43:20+00:00">April 15, 2021 at 9:43 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Thank you kindly for sharing your code!  I used your model as a basis for my Capstone project in Computer Science.  On that note, when was this post published?  I want to properly reference your work in my paper.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-197" data-commentid="197" data-postid="3266" data-belowelement="comment-197" data-respondelement="respond" data-replyto="Reply to Nathaniel Kren" aria-label="Reply to Nathaniel Kren">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				<ol class="children">
				<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-199">

					<article id="comment-199" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/32461ffa804faacb2279c6b84ccf1f52.png" srcset="https://secure.gravatar.com/avatar/32461ffa804faacb2279c6b84ccf1f52?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Farukh Hashmi</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-199"><time datetime="2021-04-16T04:45:14+00:00">April 16, 2021 at 4:45 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hi Nathaniel<br>
I am very happy to see that this post helped you in your project. It was published on 5th-Oct-2020. You can reference it with this date.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-199" data-commentid="199" data-postid="3266" data-belowelement="comment-199" data-respondelement="respond" data-replyto="Reply to Farukh Hashmi" aria-label="Reply to Farukh Hashmi">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="comment even thread-even depth-1" id="li-comment-201">

					<article id="comment-201" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/34667c4bc3be463721d0aea312ae293a.png" srcset="https://secure.gravatar.com/avatar/34667c4bc3be463721d0aea312ae293a?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Rob</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-201"><time datetime="2021-04-19T22:35:47+00:00">April 19, 2021 at 10:35 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hi,<br>
When predicting the next 5 days based on the previous 10 days, does the program use a sliding window? In other words, the 11th day makes a prediction based on the previous 10 days, but does the 12th day know about the result from the 11th day before it makes its prediction?</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-201" data-commentid="201" data-postid="3266" data-belowelement="comment-201" data-respondelement="respond" data-replyto="Reply to Rob" aria-label="Reply to Rob">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				<ol class="children">
				<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-202">

					<article id="comment-202" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/32461ffa804faacb2279c6b84ccf1f52.png" srcset="https://secure.gravatar.com/avatar/32461ffa804faacb2279c6b84ccf1f52?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Farukh Hashmi</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-202"><time datetime="2021-04-21T12:10:00+00:00">April 21, 2021 at 12:10 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hi Rob!<br>
Yes your observation is correct. If you look at the LSTM diagram. You can see that the next time step(12th day) knows what was the prediction for previous time step(11th day). So on and so forth.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-202" data-commentid="202" data-postid="3266" data-belowelement="comment-202" data-respondelement="respond" data-replyto="Reply to Farukh Hashmi" aria-label="Reply to Farukh Hashmi">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="comment even thread-odd thread-alt depth-1" id="li-comment-222">

					<article id="comment-222" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/6691cf7a899c466b7049e997b1c75912.png" srcset="https://secure.gravatar.com/avatar/6691cf7a899c466b7049e997b1c75912?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Samus</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-222"><time datetime="2021-06-07T04:43:42+00:00">June 7, 2021 at 4:43 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>I think there is something wrong with that part where you’re predicting prices for the next 5 days.<br>
So you’re using a batch size of 10 to predict a 5 days output. </p>
<p>1st batch:<br>
input: from 9/7/2020 to 9/18/2020<br>
output: from 8/31/2020 to 9/4/2020</p>
<p>2nd batch:<br>
input: from 9/8/2020 to 9/21/2020<br>
output: from 9/7/2020 to 9/11/2020<br>
And so on.<br>
I mean, look at the first batch. Your input is a window from 9/7 to 9/18 to predict prices from 8/31 to 9/4 that would be actually in the past.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-222" data-commentid="222" data-postid="3266" data-belowelement="comment-222" data-respondelement="respond" data-replyto="Reply to Samus" aria-label="Reply to Samus">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				<ol class="children">
				<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-224">

					<article id="comment-224" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/32461ffa804faacb2279c6b84ccf1f52.png" srcset="https://secure.gravatar.com/avatar/32461ffa804faacb2279c6b84ccf1f52?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Farukh Hashmi</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-224"><time datetime="2021-06-11T13:15:25+00:00">June 11, 2021 at 1:15 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hi Samus,</p>
<p>The model uses the last 10 days of prices to predict the next 5 days.<br>
Please print the X_test[-5: ] and y_test[-5: ] to check the last five input and output pairs that are fed to the LSTM model. It will make things clear for you.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-224" data-commentid="224" data-postid="3266" data-belowelement="comment-224" data-respondelement="respond" data-replyto="Reply to Farukh Hashmi" aria-label="Reply to Farukh Hashmi">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="comment even thread-even depth-1" id="li-comment-272">

					<article id="comment-272" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/35ca4ad9ae9869a72494dc95166196ac.png" srcset="https://secure.gravatar.com/avatar/35ca4ad9ae9869a72494dc95166196ac?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Paddy</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-272"><time datetime="2021-09-11T17:12:42+00:00">September 11, 2021 at 5:12 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hi,<br>
Every time I run the code I get different accuracy %, keeping everything constant.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-272" data-commentid="272" data-postid="3266" data-belowelement="comment-272" data-respondelement="respond" data-replyto="Reply to Paddy" aria-label="Reply to Paddy">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				<ol class="children">
				<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-273">

					<article id="comment-273" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/32461ffa804faacb2279c6b84ccf1f52.png" srcset="https://secure.gravatar.com/avatar/32461ffa804faacb2279c6b84ccf1f52?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Farukh Hashmi</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-273"><time datetime="2021-09-13T08:59:29+00:00">September 13, 2021 at 8:59 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hi Paddy,</p>
<p>The Neural network begins by “randomly” initializing the weights for every neuron even if you keep all the parameters the same and even if you use a seed value. Hence, every time you train it, a slightly different accuracy % will be observed. This is expected behavior.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-273" data-commentid="273" data-postid="3266" data-belowelement="comment-273" data-respondelement="respond" data-replyto="Reply to Farukh Hashmi" aria-label="Reply to Farukh Hashmi">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="comment even thread-odd thread-alt depth-1" id="li-comment-290">

					<article id="comment-290" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/562275d39f6261751ff6c2a2ef937200.png" srcset="https://secure.gravatar.com/avatar/562275d39f6261751ff6c2a2ef937200?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Pius Appiah</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-290"><time datetime="2021-11-04T06:33:48+00:00">November 4, 2021 at 6:33 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Thank you for this insightful notebook.  It has been of much help to me. I realized this is a univariate model, I want to know if it is possible to upload a multivariate for for us?. Thank you</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-290" data-commentid="290" data-postid="3266" data-belowelement="comment-290" data-respondelement="respond" data-replyto="Reply to Pius Appiah" aria-label="Reply to Pius Appiah">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				<ol class="children">
				<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-294">

					<article id="comment-294" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/32461ffa804faacb2279c6b84ccf1f52.png" srcset="https://secure.gravatar.com/avatar/32461ffa804faacb2279c6b84ccf1f52?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Farukh Hashmi</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-294"><time datetime="2021-11-10T17:44:14+00:00">November 10, 2021 at 5:44 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hi Pius!</p>
<p>I am glad to see that this post helped you! Yes, there is a multivariate version possible for LSTM, but I will suggest you to use ANN in such scenarios. I will try to upload a multivariate version for this notebook in the future! Currently, I am busy working on video tutorials of these concepts 🙂</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-294" data-commentid="294" data-postid="3266" data-belowelement="comment-294" data-respondelement="respond" data-replyto="Reply to Farukh Hashmi" aria-label="Reply to Farukh Hashmi">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="comment even thread-even depth-1" id="li-comment-291">

					<article id="comment-291" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/b0d3c6fed6f94a0d285b86007871eeb6.png" srcset="https://secure.gravatar.com/avatar/b0d3c6fed6f94a0d285b86007871eeb6?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">mengop</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-291"><time datetime="2021-11-06T07:53:47+00:00">November 6, 2021 at 7:53 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hi , thank you for sharing this, How to use the combination of trade volumes,Open , High, Low values along with Close, as LSTM input. Instead of single script, can we use the LSTM to check more scripts using single model</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-291" data-commentid="291" data-postid="3266" data-belowelement="comment-291" data-respondelement="respond" data-replyto="Reply to mengop" aria-label="Reply to mengop">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				<ol class="children">
				<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-293">

					<article id="comment-293" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/32461ffa804faacb2279c6b84ccf1f52.png" srcset="https://secure.gravatar.com/avatar/32461ffa804faacb2279c6b84ccf1f52?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Farukh Hashmi</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-293"><time datetime="2021-11-10T17:40:55+00:00">November 10, 2021 at 5:40 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hi Mengop!</p>
<p>If you are using Open, High, Low prices as predictors, then it really becomes a supervised ML problem, instead of a sequence learning problem.<br>
Hence use of ANN/XGB etc. would be more sensible.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-293" data-commentid="293" data-postid="3266" data-belowelement="comment-293" data-respondelement="respond" data-replyto="Reply to Farukh Hashmi" aria-label="Reply to Farukh Hashmi">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="comment even thread-odd thread-alt depth-1" id="li-comment-299">

					<article id="comment-299" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/7565bb0302c5de0789edde78c546beed.png" srcset="https://secure.gravatar.com/avatar/7565bb0302c5de0789edde78c546beed?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Suresh</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-299"><time datetime="2021-11-22T08:03:49+00:00">November 22, 2021 at 8:03 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>I am having problem in running the 5 step forecasting code from the above code giving me ### Input Data Shape ###<br>
(840, 10, 1)<br>
### Output Data Shape ###<br>
(840, 5, 1)</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-299" data-commentid="299" data-postid="3266" data-belowelement="comment-299" data-respondelement="respond" data-replyto="Reply to Suresh" aria-label="Reply to Suresh">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				<ol class="children">
				<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-300">

					<article id="comment-300" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/32461ffa804faacb2279c6b84ccf1f52.png" srcset="https://secure.gravatar.com/avatar/32461ffa804faacb2279c6b84ccf1f52?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Farukh Hashmi</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-300"><time datetime="2021-11-22T08:38:45+00:00">November 22, 2021 at 8:38 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hi Suresh,</p>
<p>The output data shape does not look correct.<br>
It should be (840,5). Make sure you don’t convert the output data in 3D shape.</p>
<p>Regards,<br>
Farukh Hashmi</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-300" data-commentid="300" data-postid="3266" data-belowelement="comment-300" data-respondelement="respond" data-replyto="Reply to Farukh Hashmi" aria-label="Reply to Farukh Hashmi">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="comment even thread-even depth-1" id="li-comment-304">

					<article id="comment-304" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/4bffe8da83fecd67942f5800b98046fb.png" srcset="https://secure.gravatar.com/avatar/4bffe8da83fecd67942f5800b98046fb?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Natasha L</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-304"><time datetime="2021-11-24T23:19:08+00:00">November 24, 2021 at 11:19 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>hi just wondering why it takes a very long time to get the historical data here:<br>
StockData=get_history(symbol=’INFY’, start=startDate, end=endDate)<br>
Thanks</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-304" data-commentid="304" data-postid="3266" data-belowelement="comment-304" data-respondelement="respond" data-replyto="Reply to Natasha L" aria-label="Reply to Natasha L">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				<ol class="children">
				<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-305">

					<article id="comment-305" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/32461ffa804faacb2279c6b84ccf1f52.png" srcset="https://secure.gravatar.com/avatar/32461ffa804faacb2279c6b84ccf1f52?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Farukh Hashmi</b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-305"><time datetime="2021-11-25T04:10:57+00:00">November 25, 2021 at 4:10 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hi Natasha,</p>
<p>This should ideally take a few seconds only.</p>
<p>Regards<br>
Farukh Hashmi</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-305" data-commentid="305" data-postid="3266" data-belowelement="comment-305" data-respondelement="respond" data-replyto="Reply to Farukh Hashmi" aria-label="Reply to Farukh Hashmi">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="comment even thread-odd thread-alt depth-1" id="li-comment-359">

					<article id="comment-359" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/96070dc36120505f928fe61e1574fb93.jpeg" srcset="https://secure.gravatar.com/avatar/96070dc36120505f928fe61e1574fb93?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn"><a href="https://joapen.com/" class="url" rel="ugc external nofollow">joapen</a></b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-359"><time datetime="2021-12-27T15:01:46+00:00">December 27, 2021 at 3:01 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>hello,<br>
thank you so much for the detailed description and the details on the post. The tone and details of trivial information is really useful. For instance, the section “How to predict the stock price for tomorrow” is really useful.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-359" data-commentid="359" data-postid="3266" data-belowelement="comment-359" data-respondelement="respond" data-replyto="Reply to joapen" aria-label="Reply to joapen">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				<ol class="children">
				<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-360">

					<article id="comment-360" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/32461ffa804faacb2279c6b84ccf1f52.png" srcset="https://secure.gravatar.com/avatar/32461ffa804faacb2279c6b84ccf1f52?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn"><a href="https://thinkingneuron.com/" class="url" rel="ugc">Farukh Hashmi</a></b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-360"><time datetime="2021-12-27T15:14:02+00:00">December 27, 2021 at 3:14 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hi Joa!</p>
<p>Thank you for your kind words! </p>
<p>Regards,<br>
Farukh Hashmi</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-360" data-commentid="360" data-postid="3266" data-belowelement="comment-360" data-respondelement="respond" data-replyto="Reply to Farukh Hashmi" aria-label="Reply to Farukh Hashmi">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="comment even thread-even depth-1" id="li-comment-363">

					<article id="comment-363" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/96070dc36120505f928fe61e1574fb93.jpeg" srcset="https://secure.gravatar.com/avatar/96070dc36120505f928fe61e1574fb93?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn"><a href="https://joapen.com/" class="url" rel="ugc external nofollow">joapen</a></b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-363"><time datetime="2021-12-29T12:55:48+00:00">December 29, 2021 at 12:55 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hello Farukh,<br>
I have a question about the epochs. For instance, the use of epochs=100 seems to produce a more accurate model than the one with epochs=10.</p>
<p>How would be the behavior if we set epcohs=200 or 1000?</p>
<p>Overfitting? no real improvement?</p>
<p>many thanks in advance</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-363" data-commentid="363" data-postid="3266" data-belowelement="comment-363" data-respondelement="respond" data-replyto="Reply to joapen" aria-label="Reply to joapen">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				<ol class="children">
				<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-368">

					<article id="comment-368" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/32461ffa804faacb2279c6b84ccf1f52.png" srcset="https://secure.gravatar.com/avatar/32461ffa804faacb2279c6b84ccf1f52?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn"><a href="https://thinkingneuron.com/" class="url" rel="ugc">Farukh Hashmi</a></b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-368"><time datetime="2022-01-02T10:34:32+00:00">January 2, 2022 at 10:34 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hi Joa,<br>
You are correct in observing that higher epoch produces more accurate model. But, there is a sweet spot value of epoch for every data which we need to find by trying out multiple values of epoch under the hyperparameter tuning step. Let’s say in this data you tried epoch=500 and it gave 90% accuracy as compared to epoch=10 which produced 60% accuracy. So you will try epoch= 600 which may give you 91% accuracy. The change in accuracy will hit a saturation level. That is the point we need to find. Because if you keep increasing the epochs, the test accuracy will start decreasing… That’s when you know it is overfitting.<br>
Hope that helps!</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-368" data-commentid="368" data-postid="3266" data-belowelement="comment-368" data-respondelement="respond" data-replyto="Reply to Farukh Hashmi" aria-label="Reply to Farukh Hashmi">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				<ol class="children">
				<li class="comment even depth-3" id="li-comment-371">

					<article id="comment-371" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/96070dc36120505f928fe61e1574fb93.jpeg" srcset="https://secure.gravatar.com/avatar/96070dc36120505f928fe61e1574fb93?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn"><a href="https://joapen.com/" class="url" rel="ugc external nofollow">joapen</a></b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-371"><time datetime="2022-01-03T21:39:31+00:00">January 3, 2022 at 9:39 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Many thanks Farukh, yes, it helps too much!</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-371" data-commentid="371" data-postid="3266" data-belowelement="comment-371" data-respondelement="respond" data-replyto="Reply to joapen" aria-label="Reply to joapen">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
				<li class="comment odd alt depth-3" id="li-comment-374">

					<article id="comment-374" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/f316fbd4987e36e60a82f637ff5e46b9.png" srcset="https://secure.gravatar.com/avatar/f316fbd4987e36e60a82f637ff5e46b9?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Sarah</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-374"><time datetime="2022-01-05T11:02:37+00:00">January 5, 2022 at 11:02 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Also normalizing the whole datasets leads to data leakage from test set, hence results are not valid.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-374" data-commentid="374" data-postid="3266" data-belowelement="comment-374" data-respondelement="respond" data-replyto="Reply to Sarah" aria-label="Reply to Sarah">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				<ol class="children">
				<li class="comment byuser comment-author-admin bypostauthor even depth-4" id="li-comment-383">

					<article id="comment-383" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/32461ffa804faacb2279c6b84ccf1f52.png" srcset="https://secure.gravatar.com/avatar/32461ffa804faacb2279c6b84ccf1f52?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn"><a href="https://thinkingneuron.com/" class="url" rel="ugc">Farukh Hashmi</a></b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-383"><time datetime="2022-01-22T11:00:04+00:00">January 22, 2022 at 11:00 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hi Sarah,</p>
<p>Thank you for pointing this out! I generally use a third piece called validation set kept totally away from training and testing. On that data, the normalization is done using the normalization fit object of train data. I have not shown that concept in this case study.</p>
<p>Regards,<br>
Farukh Hashmi</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-383" data-commentid="383" data-postid="3266" data-belowelement="comment-383" data-respondelement="respond" data-replyto="Reply to Farukh Hashmi" aria-label="Reply to Farukh Hashmi">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				<ol class="children">
				<li class="comment odd alt depth-5" id="li-comment-651">

					<article id="comment-651" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/d7d0748df2ffd624830a95caf79edad8.png" srcset="https://secure.gravatar.com/avatar/d7d0748df2ffd624830a95caf79edad8?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Isabella</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-651"><time datetime="2023-03-08T20:34:06+00:00">March 8, 2023 at 8:34 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>I was thinking the same thing – missing the validation set. Would be great if you could show how you would implement this.</p>
								<div class="ast-comment-edit-reply-wrap">
																										</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="comment even thread-odd thread-alt depth-1" id="li-comment-373">

					<article id="comment-373" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/41aa8e62829ee92d2834bde185ebac40.png" srcset="https://secure.gravatar.com/avatar/41aa8e62829ee92d2834bde185ebac40?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Tony</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-373"><time datetime="2022-01-04T19:03:16+00:00">January 4, 2022 at 7:03 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hi,<br>
I think, normalization should be applied after splitting (fit_transform to train, and fit to test), otherwise your model i gaining information from the test sample, which should’nt do.</p>
<p>Regards,</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-373" data-commentid="373" data-postid="3266" data-belowelement="comment-373" data-respondelement="respond" data-replyto="Reply to Tony" aria-label="Reply to Tony">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				<ol class="children">
				<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-382">

					<article id="comment-382" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/32461ffa804faacb2279c6b84ccf1f52.png" srcset="https://secure.gravatar.com/avatar/32461ffa804faacb2279c6b84ccf1f52?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn"><a href="https://thinkingneuron.com/" class="url" rel="ugc">Farukh Hashmi</a></b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-382"><time datetime="2022-01-22T10:57:41+00:00">January 22, 2022 at 10:57 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hi Tony,</p>
<p>I think you are pointing towards the validation data. Yes, you can keep some data separate apart from Train and test, and use the fit object from model training to normalize it while generating predictions for it. In this case study, I have not shown this part. Thank you for pointing 🙂</p>
<p>Regards,<br>
Farukh Hashmi</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-382" data-commentid="382" data-postid="3266" data-belowelement="comment-382" data-respondelement="respond" data-replyto="Reply to Farukh Hashmi" aria-label="Reply to Farukh Hashmi">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="comment even thread-even depth-1" id="li-comment-439">

					<article id="comment-439" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/15b3a26f827d6d4749b45c096aff090e.png" srcset="https://secure.gravatar.com/avatar/15b3a26f827d6d4749b45c096aff090e?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Magnus Christensen</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-439"><time datetime="2022-03-12T11:01:44+00:00">March 12, 2022 at 11:01 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hi,</p>
<p>Great example!<br>
How would you alter this code for a dataset with more than one variable (more features)?</p>
<p>Thank you in advance!</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-439" data-commentid="439" data-postid="3266" data-belowelement="comment-439" data-respondelement="respond" data-replyto="Reply to Magnus Christensen" aria-label="Reply to Magnus Christensen">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
				<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-441">

					<article id="comment-441" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/15b3a26f827d6d4749b45c096aff090e.png" srcset="https://secure.gravatar.com/avatar/15b3a26f827d6d4749b45c096aff090e?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Magnus</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-441"><time datetime="2022-03-13T15:32:27+00:00">March 13, 2022 at 3:32 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hi, </p>
<p>Great working example!  How would this code be altered to fit a multivariate dataset?</p>
<p>Thanks in advance!</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-441" data-commentid="441" data-postid="3266" data-belowelement="comment-441" data-respondelement="respond" data-replyto="Reply to Magnus" aria-label="Reply to Magnus">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
				<li class="comment even thread-even depth-1" id="li-comment-548">

					<article id="comment-548" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/7e549660876293f4298fb5298530004a.png" srcset="https://secure.gravatar.com/avatar/7e549660876293f4298fb5298530004a?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">wilson gomes</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-548"><time datetime="2022-09-16T14:19:21+00:00">September 16, 2022 at 2:19 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>good job man.Hugs from Brazil</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-548" data-commentid="548" data-postid="3266" data-belowelement="comment-548" data-respondelement="respond" data-replyto="Reply to wilson gomes" aria-label="Reply to wilson gomes">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				<ol class="children">
				<li class="comment byuser comment-author-admin bypostauthor odd alt depth-2" id="li-comment-549">

					<article id="comment-549" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/32461ffa804faacb2279c6b84ccf1f52.png" srcset="https://secure.gravatar.com/avatar/32461ffa804faacb2279c6b84ccf1f52?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn"><a href="https://thinkingneuron.com/" class="url" rel="ugc">Farukh Hashmi</a></b> <span class="ast-highlight-text ast-cmt-post-author"></span></cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-549"><time datetime="2022-09-16T14:34:39+00:00">September 16, 2022 at 2:34 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Thank you for the kind words!</p>
<p>Cheers!<br>
Farukh Hashmi</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-549" data-commentid="549" data-postid="3266" data-belowelement="comment-549" data-respondelement="respond" data-replyto="Reply to Farukh Hashmi" aria-label="Reply to Farukh Hashmi">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
				<li class="comment even thread-odd thread-alt depth-1" id="li-comment-611">

					<article id="comment-611" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/1b613575a407004436ee9903ed698bf1.png" srcset="https://secure.gravatar.com/avatar/1b613575a407004436ee9903ed698bf1?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Bergen Dahl</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-611"><time datetime="2023-01-17T04:18:01+00:00">January 17, 2023 at 4:18 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hello. I have copied all of the code but I am getting the error message<br>
NameError                                 Traceback (most recent call last)<br>
Cell In[59], line 363<br>
    360     plt.show()<br>
    362 # Making predictions on test data<br>
–&gt; 363 Last10DaysPrices=array([1376.2, 1371.75,1387.15,1370.5 ,1344.95,<br>
    364                    1312.05, 1316.65, 1339.45, 1339.7 ,1340.85])<br>
    366 # Reshaping the data to (-1,1 )because its a single entry<br>
    367 Last10DaysPrices=Last10DaysPrices.reshape(-1, 1)</p>
<p>NameError: name ‘array’ is not defined<br>
I also tried using data for CROX up until about last friday but I ran into an error where no stock data was available. Thanks again. This code is awesome no doubt.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-611" data-commentid="611" data-postid="3266" data-belowelement="comment-611" data-respondelement="respond" data-replyto="Reply to Bergen Dahl" aria-label="Reply to Bergen Dahl">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
				<li class="comment odd alt thread-even depth-1" id="li-comment-634">

					<article id="comment-634" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/7e549660876293f4298fb5298530004a.png" srcset="https://secure.gravatar.com/avatar/7e549660876293f4298fb5298530004a?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">wilson gomes</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-634"><time datetime="2023-02-13T21:20:55+00:00">February 13, 2023 at 9:20 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Very good job; thanks for your dedication!!!!</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-634" data-commentid="634" data-postid="3266" data-belowelement="comment-634" data-respondelement="respond" data-replyto="Reply to wilson gomes" aria-label="Reply to wilson gomes">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
				<li class="comment even thread-odd thread-alt depth-1" id="li-comment-641">

					<article id="comment-641" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/c53b1b8b05271484c74d09da2d0cd9a0.png" srcset="https://secure.gravatar.com/avatar/c53b1b8b05271484c74d09da2d0cd9a0?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Mike</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-641"><time datetime="2023-02-20T23:52:04+00:00">February 20, 2023 at 11:52 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>In your example, you predicted for every 5 days. How to make a 5-day prediction for each day, not in 5 days intervals. Thanks.</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-641" data-commentid="641" data-postid="3266" data-belowelement="comment-641" data-respondelement="respond" data-replyto="Reply to Mike" aria-label="Reply to Mike">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
				<li class="comment odd alt thread-even depth-1" id="li-comment-663">

					<article id="comment-663" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/8b1a2b454457e901c8f89028cd7d6adb.png" srcset="https://secure.gravatar.com/avatar/8b1a2b454457e901c8f89028cd7d6adb?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">AB</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-663"><time datetime="2023-05-01T22:14:40+00:00">May 1, 2023 at 10:14 pm</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>It isn’t showing data with the error being data connection is full. what should i do?</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-663" data-commentid="663" data-postid="3266" data-belowelement="comment-663" data-respondelement="respond" data-replyto="Reply to AB" aria-label="Reply to AB">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
				<li class="comment even thread-odd thread-alt depth-1" id="li-comment-745">

					<article id="comment-745" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/d989b854ceaaf6e3f21926c450351318.png" srcset="https://secure.gravatar.com/avatar/d989b854ceaaf6e3f21926c450351318?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Md. Motiur Rahman</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-745"><time datetime="2023-09-25T05:11:58+00:00">September 25, 2023 at 5:11 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Hello, Mr. Hashmi, I am Md. Motiur Rahman, from Bangladesh. I am working in a private manufacturing company, we are now going to be data driven organization, we have historical data in every phase (procurement, production, inventory, sales, supply chain etc. etc.). We are very much Interested to use machine learning techniques so that we can forecast or predict ( sales, customer next purchases date for next 30 days, inventory control etc. etc. ), so we can take decision from the output of our analysis, as we are beginner in this fields. Would you please can supervised us in this case, If you can then how can we get this guidance. Thank You<br>
Sincerely<br>
Md. Motiur Rahman</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-745" data-commentid="745" data-postid="3266" data-belowelement="comment-745" data-respondelement="respond" data-replyto="Reply to Md. Motiur Rahman" aria-label="Reply to Md. Motiur Rahman">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
				<li class="comment odd alt thread-even depth-1" id="li-comment-746">

					<article id="comment-746" class="ast-comment">
						<div class="ast-comment-avatar-wrap"><img alt="" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/d989b854ceaaf6e3f21926c450351318.png" srcset="https://secure.gravatar.com/avatar/d989b854ceaaf6e3f21926c450351318?s=100&amp;d=mm&amp;r=g 2x" class="avatar avatar-50 photo" height="50" width="50" loading="lazy" decoding="async"></div><!-- Remove 1px Space
						--><div class="ast-comment-data-wrap">
							<div class="ast-comment-meta-wrap">
								<header class="ast-comment-meta ast-row ast-comment-author vcard capitalize">

									<div class="ast-comment-cite-wrap ast-col-lg-12"><cite><b class="fn">Md. Motiur Rahman</b> </cite></div><div class="ast-comment-time ast-col-lg-12"><span class="timendate"><a href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-746"><time datetime="2023-09-25T05:17:20+00:00">September 25, 2023 at 5:17 am</time></a></span></div>
								</header> <!-- .ast-comment-meta -->
							</div>
							<section class="ast-comment-content comment">
								<p>Dear Mr. Hashmi,<br>
I hope this message finds you well. My name is Md. Motiur Rahman, and I am writing to you from Bangladesh. I am currently employed at a private manufacturing company where we are in the process of transitioning into a data-driven organization. We possess comprehensive historical data across various phases of our operations including procurement, production, inventory, sales, and supply chain management.</p>
<p>We have a keen interest in leveraging machine learning techniques to facilitate accurate forecasting and prediction tasks such as sales projections, anticipating customer purchases for the forthcoming 30 days, and optimizing inventory management, among other objectives. This, we believe, will enable us to make informed decisions based on the insights gleaned from our analyses.<br>
Given our relatively nascent foray into this domain, we are seeking guidance and mentorship in this endeavor. I would greatly appreciate it if you could extend your expertise and support in our pursuit. Could you kindly advise on the most suitable means through which we may avail of your valuable guidance?<br>
Thank you for considering our request.</p>
<p>Sincerely,<br>
Md. Motiur Rahman</p>
<p>Regenerate</p>
								<div class="ast-comment-edit-reply-wrap">
																		<span class="ast-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#comment-746" data-commentid="746" data-postid="3266" data-belowelement="comment-746" data-respondelement="respond" data-replyto="Reply to Md. Motiur Rahman" aria-label="Reply to Md. Motiur Rahman">Reply</a></span>								</div>
															</section> <!-- .ast-comment-content -->
						</div>
					</article><!-- #comment-## -->
				<!-- </li> -->
				</li><!-- #comment-## -->
		</ol><!-- .ast-comment-list -->

		
	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply! <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://thinkingneuron.com/predicting-stock-prices-using-deep-learning-lstm-model-in-python/#respond" style="display:none;">Cancel Reply</a></small></h3><form action="https://thinkingneuron.com/wp-comments-post.php" method="post" id="ast-commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> <span class="required-field-message">Required fields are marked <span class="required">*</span></span></p><p class="comment-form-comment"><label for="comment">Comment</label><br><textarea id="comment" name="comment" aria-required="true"></textarea></p><div class="ast-comment-formwrap ast-row"><p class="comment-form-author ast-col-xs-12 ast-col-sm-12 ast-col-md-4 ast-col-lg-4"><label for="author" class="screen-reader-text">Name*</label><input id="author" name="author" type="text" value="" placeholder="Name*" size="30" aria-required="true"></p>
<p class="comment-form-email ast-col-xs-12 ast-col-sm-12 ast-col-md-4 ast-col-lg-4"><label for="email" class="screen-reader-text">Email*</label><input id="email" name="email" type="text" value="" placeholder="Email*" size="30" aria-required="true"></p>
<p class="comment-form-url ast-col-xs-12 ast-col-sm-12 ast-col-md-4 ast-col-lg-4"><label for="url"><label for="url" class="screen-reader-text">Website</label><input id="url" name="url" type="text" value="" placeholder="Website" size="30"></label></p></div>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit"> <input type="hidden" name="comment_post_ID" value="3266" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="0518131022"></p><p style="display: none;"></p></form>	</div><!-- #respond -->
	
	
</div><!-- #comments -->

					
					
				
			</main><!-- #main -->
			
		
	</div><!-- #primary -->


			
			</div> <!-- ast-container -->

		</div><!-- #content -->

		
		
		
		<footer itemtype="https://schema.org/WPFooter" itemscope="itemscope" id="colophon" class="site-footer" role="contentinfo">

			
			
<div class="ast-small-footer footer-sml-layout-1">
	<div class="ast-footer-overlay">
		<div class="ast-container">
			<div class="ast-small-footer-wrap">
									<div class="ast-small-footer-section ast-small-footer-section-1">
						<div class="ast-footer-widget-1-area"><aside id="tag_cloud-3" class="widget widget_tag_cloud"><h2 class="widget-title">AI/ML Algorithms and Topics</h2><div class="tagcloud"><a href="https://thinkingneuron.com/tag/adaboost/" class="tag-cloud-link tag-link-50 tag-link-position-1" style="font-size: 13.377358490566px;" aria-label="Adaboost (3 items)">Adaboost</a>
<a href="https://thinkingneuron.com/tag/apriori/" class="tag-cloud-link tag-link-70 tag-link-position-2" style="font-size: 13px;" aria-label="Apriori (2 items)">Apriori</a>
<a href="https://thinkingneuron.com/tag/artificial-neural-network/" class="tag-cloud-link tag-link-93 tag-link-position-3" style="font-size: 13.377358490566px;" aria-label="Artificial Neural Network (3 items)">Artificial Neural Network</a>
<a href="https://thinkingneuron.com/tag/classification/" class="tag-cloud-link tag-link-42 tag-link-position-4" style="font-size: 15.264150943396px;" aria-label="Classification (15 items)">Classification</a>
<a href="https://thinkingneuron.com/tag/clustering/" class="tag-cloud-link tag-link-73 tag-link-position-5" style="font-size: 13.943396226415px;" aria-label="Clustering (5 items)">Clustering</a>
<a href="https://thinkingneuron.com/tag/cnn/" class="tag-cloud-link tag-link-90 tag-link-position-6" style="font-size: 13px;" aria-label="CNN (2 items)">CNN</a>
<a href="https://thinkingneuron.com/tag/data-frame/" class="tag-cloud-link tag-link-138 tag-link-position-7" style="font-size: 13.377358490566px;" aria-label="Data Frame (3 items)">Data Frame</a>
<a href="https://thinkingneuron.com/tag/dataframe/" class="tag-cloud-link tag-link-128 tag-link-position-8" style="font-size: 13.377358490566px;" aria-label="DataFrame (3 items)">DataFrame</a>
<a href="https://thinkingneuron.com/tag/data-pre-processing/" class="tag-cloud-link tag-link-169 tag-link-position-9" style="font-size: 13px;" aria-label="Data Pre Processing (2 items)">Data Pre Processing</a>
<a href="https://thinkingneuron.com/tag/data-science/" class="tag-cloud-link tag-link-16 tag-link-position-10" style="font-size: 14.88679245283px;" aria-label="Data Science (11 items)">Data Science</a>
<a href="https://thinkingneuron.com/tag/decision-tree/" class="tag-cloud-link tag-link-48 tag-link-position-11" style="font-size: 13.377358490566px;" aria-label="Decision Tree (3 items)">Decision Tree</a>
<a href="https://thinkingneuron.com/tag/deep-learning/" class="tag-cloud-link tag-link-207 tag-link-position-12" style="font-size: 13.377358490566px;" aria-label="Deep Learning (3 items)">Deep Learning</a>
<a href="https://thinkingneuron.com/tag/eclat/" class="tag-cloud-link tag-link-71 tag-link-position-13" style="font-size: 13px;" aria-label="Eclat (2 items)">Eclat</a>
<a href="https://thinkingneuron.com/tag/feature-selection/" class="tag-cloud-link tag-link-160 tag-link-position-14" style="font-size: 14.635220125786px;" aria-label="Feature Selection (9 items)">Feature Selection</a>
<a href="https://thinkingneuron.com/tag/fp-growth/" class="tag-cloud-link tag-link-72 tag-link-position-15" style="font-size: 13px;" aria-label="FP-Growth (2 items)">FP-Growth</a>
<a href="https://thinkingneuron.com/tag/hyperparameter-tuning/" class="tag-cloud-link tag-link-195 tag-link-position-16" style="font-size: 13.691823899371px;" aria-label="Hyperparameter Tuning (4 items)">Hyperparameter Tuning</a>
<a href="https://thinkingneuron.com/tag/ica/" class="tag-cloud-link tag-link-66 tag-link-position-17" style="font-size: 13px;" aria-label="ICA (2 items)">ICA</a>
<a href="https://thinkingneuron.com/tag/knn/" class="tag-cloud-link tag-link-52 tag-link-position-18" style="font-size: 13.377358490566px;" aria-label="KNN (3 items)">KNN</a>
<a href="https://thinkingneuron.com/tag/library/" class="tag-cloud-link tag-link-155 tag-link-position-19" style="font-size: 13px;" aria-label="library (2 items)">library</a>
<a href="https://thinkingneuron.com/tag/lstm/" class="tag-cloud-link tag-link-92 tag-link-position-20" style="font-size: 13px;" aria-label="LSTM (2 items)">LSTM</a>
<a href="https://thinkingneuron.com/tag/machine-learning/" class="tag-cloud-link tag-link-17 tag-link-position-21" style="font-size: 16.396226415094px;" aria-label="Machine Learning (35 items)">Machine Learning</a>
<a href="https://thinkingneuron.com/tag/nlp/" class="tag-cloud-link tag-link-185 tag-link-position-22" style="font-size: 14.163522012579px;" aria-label="NLP (6 items)">NLP</a>
<a href="https://thinkingneuron.com/tag/pandas/" class="tag-cloud-link tag-link-127 tag-link-position-23" style="font-size: 15.201257861635px;" aria-label="Pandas (14 items)">Pandas</a>
<a href="https://thinkingneuron.com/tag/pca/" class="tag-cloud-link tag-link-65 tag-link-position-24" style="font-size: 13px;" aria-label="PCA (2 items)">PCA</a>
<a href="https://thinkingneuron.com/tag/pos/" class="tag-cloud-link tag-link-189 tag-link-position-25" style="font-size: 13px;" aria-label="POS (2 items)">POS</a>
<a href="https://thinkingneuron.com/tag/programming/" class="tag-cloud-link tag-link-115 tag-link-position-26" style="font-size: 15.578616352201px;" aria-label="Programming (19 items)">Programming</a>
<a href="https://thinkingneuron.com/tag/python/" class="tag-cloud-link tag-link-37 tag-link-position-27" style="font-size: 18px;" aria-label="Python (117 items)">Python</a>
<a href="https://thinkingneuron.com/tag/python-basics-for-machine-learning/" class="tag-cloud-link tag-link-116 tag-link-position-28" style="font-size: 17.088050314465px;" aria-label="Python Basics For Machine Learning (59 items)">Python Basics For Machine Learning</a>
<a href="https://thinkingneuron.com/tag/python-case-study/" class="tag-cloud-link tag-link-202 tag-link-position-29" style="font-size: 15.264150943396px;" aria-label="Python Case Study (15 items)">Python Case Study</a>
<a href="https://thinkingneuron.com/tag/r/" class="tag-cloud-link tag-link-30 tag-link-position-30" style="font-size: 13.691823899371px;" aria-label="R (4 items)">R</a>
<a href="https://thinkingneuron.com/tag/random-forest/" class="tag-cloud-link tag-link-49 tag-link-position-31" style="font-size: 13.377358490566px;" aria-label="Random Forest (3 items)">Random Forest</a>
<a href="https://thinkingneuron.com/tag/regression/" class="tag-cloud-link tag-link-41 tag-link-position-32" style="font-size: 15.106918238994px;" aria-label="Regression (13 items)">Regression</a>
<a href="https://thinkingneuron.com/tag/sampling/" class="tag-cloud-link tag-link-25 tag-link-position-33" style="font-size: 13.691823899371px;" aria-label="Sampling (4 items)">Sampling</a>
<a href="https://thinkingneuron.com/tag/sampling-theory/" class="tag-cloud-link tag-link-24 tag-link-position-34" style="font-size: 13.691823899371px;" aria-label="Sampling Theory (4 items)">Sampling Theory</a>
<a href="https://thinkingneuron.com/tag/statistics/" class="tag-cloud-link tag-link-9 tag-link-position-35" style="font-size: 14.320754716981px;" aria-label="Statistics (7 items)">Statistics</a>
<a href="https://thinkingneuron.com/tag/statistics-for-data-science/" class="tag-cloud-link tag-link-23 tag-link-position-36" style="font-size: 13.691823899371px;" aria-label="Statistics for Data Science (4 items)">Statistics for Data Science</a>
<a href="https://thinkingneuron.com/tag/supervised-machine-learning/" class="tag-cloud-link tag-link-38 tag-link-position-37" style="font-size: 16.176100628931px;" aria-label="Supervised Machine Learning (30 items)">Supervised Machine Learning</a>
<a href="https://thinkingneuron.com/tag/svm/" class="tag-cloud-link tag-link-53 tag-link-position-38" style="font-size: 13.377358490566px;" aria-label="SVM (3 items)">SVM</a>
<a href="https://thinkingneuron.com/tag/t-sne/" class="tag-cloud-link tag-link-67 tag-link-position-39" style="font-size: 13px;" aria-label="T-SNE (2 items)">T-SNE</a>
<a href="https://thinkingneuron.com/tag/text-mining/" class="tag-cloud-link tag-link-176 tag-link-position-40" style="font-size: 14.635220125786px;" aria-label="Text Mining (9 items)">Text Mining</a>
<a href="https://thinkingneuron.com/tag/tf-idf/" class="tag-cloud-link tag-link-194 tag-link-position-41" style="font-size: 13px;" aria-label="TF-IDF (2 items)">TF-IDF</a>
<a href="https://thinkingneuron.com/tag/umap/" class="tag-cloud-link tag-link-68 tag-link-position-42" style="font-size: 13px;" aria-label="UMAP (2 items)">UMAP</a>
<a href="https://thinkingneuron.com/tag/unsupervised-machine-learning/" class="tag-cloud-link tag-link-39 tag-link-position-43" style="font-size: 15.264150943396px;" aria-label="Unsupervised Machine Learning (15 items)">Unsupervised Machine Learning</a>
<a href="https://thinkingneuron.com/tag/wordcloud/" class="tag-cloud-link tag-link-178 tag-link-position-44" style="font-size: 13.377358490566px;" aria-label="Wordcloud (3 items)">Wordcloud</a>
<a href="https://thinkingneuron.com/tag/xgboost/" class="tag-cloud-link tag-link-51 tag-link-position-45" style="font-size: 13.377358490566px;" aria-label="Xgboost (3 items)">Xgboost</a></div>
</aside></div>					</div>
				
									<div class="ast-small-footer-section ast-small-footer-section-2">
						Powered by <span class="ast-footer-site-title">Thinking Neuron</span>					</div>
				
			</div><!-- .ast-row .ast-small-footer-wrap -->
		</div><!-- .ast-container -->
	</div><!-- .ast-footer-overlay -->
</div><!-- .ast-small-footer-->

			
		</footer><!-- #colophon -->
		
		
	</div><!-- #page -->

	
	<script type="text/javascript" id="astra-theme-js-js-extra">
/* <![CDATA[ */
var astra = {"break_point":"921","isRtl":""};
/* ]]> */
</script>
<script type="text/javascript" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/style.min.js.下载" id="astra-theme-js-js"></script>
<script type="text/javascript" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/comment-reply.min.js.下载" id="comment-reply-js"></script>
<script type="text/javascript" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/imagesloaded.min.js.下载" id="imagesloaded-js"></script>
<script type="text/javascript" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/masonry.min.js.下载" id="masonry-js"></script>
<script type="text/javascript" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/jquery.masonry.min.js.下载" id="jquery-masonry-js"></script>
<script async="async" type="text/javascript" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/form.js.下载" id="akismet-form-js"></script><div id="goog-gt-tt" class="VIpgJd-yAWNEb-L7lbkb skiptranslate" style="border-radius: 12px; margin: 0 0 0 -23px; padding: 0; font-family: &#39;Google Sans&#39;, Arial, sans-serif;" data-id=""><div id="goog-gt-vt" class="VIpgJd-yAWNEb-hvhgNd"><div class=" VIpgJd-yAWNEb-hvhgNd-l4eHX-i3jM8c"><img src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/24px.svg" width="24" height="24" alt=""></div><div class=" VIpgJd-yAWNEb-hvhgNd-k77Iif-i3jM8c"><div class="VIpgJd-yAWNEb-hvhgNd-IuizWc" dir="ltr">原文</div><div id="goog-gt-original-text" class="VIpgJd-yAWNEb-nVMfcd-fmcmS VIpgJd-yAWNEb-hvhgNd-axAV1"></div></div><div class="VIpgJd-yAWNEb-hvhgNd-N7Eqid ltr"><div class="VIpgJd-yAWNEb-hvhgNd-N7Eqid-B7I4Od ltr" dir="ltr"><div class="VIpgJd-yAWNEb-hvhgNd-UTujCb">请对此翻译评分</div><div class="VIpgJd-yAWNEb-hvhgNd-eO9mKe">您的反馈将用于改进谷歌翻译</div></div><div class="VIpgJd-yAWNEb-hvhgNd-xgov5 ltr"><button id="goog-gt-thumbUpButton" type="button" class="VIpgJd-yAWNEb-hvhgNd-bgm6sf" title="翻译质量很棒" aria-label="翻译质量很棒" aria-pressed="false"><span id="goog-gt-thumbUpIcon"><svg width="24" height="24" viewBox="0 0 24 24" focusable="false" class="VIpgJd-yAWNEb-hvhgNd-THI6Vb NMm5M"><path d="M21 7h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 0S7.08 6.85 7 7H2v13h16c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73V9c0-1.1-.9-2-2-2zM7 18H4V9h3v9zm14-7l-3 7H9V8l4.34-4.34L12 9h9v2z"></path></svg></span><span id="goog-gt-thumbUpIconFilled"><svg width="24" height="24" viewBox="0 0 24 24" focusable="false" class="VIpgJd-yAWNEb-hvhgNd-THI6Vb NMm5M"><path d="M21 7h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 0S7.08 6.85 7 7v13h11c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73V9c0-1.1-.9-2-2-2zM5 7H1v13h4V7z"></path></svg></span></button><button id="goog-gt-thumbDownButton" type="button" class="VIpgJd-yAWNEb-hvhgNd-bgm6sf" title="翻译质量很差" aria-label="翻译质量很差" aria-pressed="false"><span id="goog-gt-thumbDownIcon"><svg width="24" height="24" viewBox="0 0 24 24" focusable="false" class="VIpgJd-yAWNEb-hvhgNd-THI6Vb NMm5M"><path d="M3 17h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 24s7.09-6.85 7.17-7h5V4H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2zM17 6h3v9h-3V6zM3 13l3-7h9v10l-4.34 4.34L12 15H3v-2z"></path></svg></span><span id="goog-gt-thumbDownIconFilled"><svg width="24" height="24" viewBox="0 0 24 24" focusable="false" class="VIpgJd-yAWNEb-hvhgNd-THI6Vb NMm5M"><path d="M3 17h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 24s7.09-6.85 7.17-7V4H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2zm16 0h4V4h-4v13z"></path></svg></span></button></div></div><div id="goog-gt-votingHiddenPane" class="VIpgJd-yAWNEb-hvhgNd-aXYTce"><form id="goog-gt-votingForm" action="https://translate.googleapis.com/translate_voting?client=te_lib" method="post" target="votingFrame" class="VIpgJd-yAWNEb-hvhgNd-aXYTce"><input type="text" name="sl" id="goog-gt-votingInputSrcLang"><input type="text" name="tl" id="goog-gt-votingInputTrgLang"><input type="text" name="query" id="goog-gt-votingInputSrcText"><input type="text" name="gtrans" id="goog-gt-votingInputTrgText"><input type="text" name="vote" id="goog-gt-votingInputVote"></form><iframe name="votingFrame" frameborder="0" src="./Predicting stock prices using Deep Learning LSTM model in Python - Thinking Neuron_files/saved_resource.html"></iframe></div></div></div>

	


</body><grammarly-desktop-integration data-grammarly-shadow-root="true"><template shadowrootmode="open"><style>
      div.grammarly-desktop-integration {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select:none;
        user-select:none;
      }

      div.grammarly-desktop-integration:before {
        content: attr(data-content);
      }
    </style><div aria-label="grammarly-integration" role="group" tabindex="-1" class="grammarly-desktop-integration" data-content="{&quot;mode&quot;:&quot;limited&quot;,&quot;isActive&quot;:false,&quot;isUserDisabled&quot;:false}"></div></template></grammarly-desktop-integration></html>